<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Multi-class classifiers &mdash; SimBA 0.0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css" />
      <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
      <link rel="stylesheet" type="text/css" href="../_static/css/simba_theme.css" />
      <link rel="stylesheet" type="text/css" href="../_static/custom.css" />

  
    <link rel="shortcut icon" href="../_static/readthedocs_logo.png"/>
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
        <script>let toggleHintShow = 'Click to show';</script>
        <script>let toggleHintHide = 'Click to hide';</script>
        <script>let toggleOpenOnPrint = 'true';</script>
        <script src="../_static/togglebutton.js"></script>
        <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Tutorials" href="../tutorials.html" />
    <link rel="prev" title="Import SLEAP H5 files" href="import_sleap_h5.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            SimBA
              <img src="../_static/readthedocs_logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">API REFERENCE:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api.html">API Reference</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">NOTEBOOKS:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../notebooks.html">Notebooks</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../notebooks.html#general-processing">General processing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notebooks.html#visualizations">Visualizations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notebooks.html#geometry-and-image-related-calculators">Geometry- and image-related calculators</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../notebooks.html#miscellaneous">Miscellaneous</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="import_sleap_h5.html">Import SLEAP H5 files</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Multi-class classifiers</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#CREATE-MULTI-CLASS-CLASSIFIERS-REQUIREMENTS">CREATE MULTI-CLASS CLASSIFIERS REQUIREMENTS</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">USER GUIDE / TUTORIALS:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorials.html">Tutorials</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">WALKTHROUGHS:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../walkthroughs.html">Walkthroughs</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">LABELLING TUTORIALS:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../labelling.html">Labelling</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">FAQ:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorials_rst/FAQ.html">Friendly Asked Questions (FAQ)</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">DOCS:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../docs/workflow.html">SimBA basic workflow</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">ABOUT:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../credits.html">Credits</a></li>
<li class="toctree-l1"><a class="reference internal" href="../credits.html#who-writes-this-stuff">Who writes this stuff??</a></li>
<li class="toctree-l1"><a class="reference internal" href="../links.html">Links</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">SimBA</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../notebooks.html">Notebooks</a></li>
      <li class="breadcrumb-item active">Multi-class classifiers</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/nb/multiclass.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt .copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<section id="Multi-class-classifiers">
<h1>Multi-class classifiers<a class="headerlink" href="#Multi-class-classifiers" title="Permalink to this heading"></a></h1>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">simba.model.train_multiclass_rf</span> <span class="kn">import</span> <span class="n">TrainMultiClassRandomForestClassifier</span>
<span class="kn">from</span> <span class="nn">simba.model.grid_search_multiclass_rf</span> <span class="kn">import</span> <span class="n">GridSearchMulticlassRandomForestClassifier</span>
<span class="kn">from</span> <span class="nn">simba.model.inference_multiclass_batch</span> <span class="kn">import</span> <span class="n">InferenceMulticlassBatch</span>
<span class="kn">from</span> <span class="nn">simba.plotting.plot_multiclass_clf_results</span> <span class="kn">import</span> <span class="n">PlotMulticlassSklearnResultsSingleCore</span>
</pre></div>
</div>
</div>
<section id="CREATE-MULTI-CLASS-CLASSIFIERS-REQUIREMENTS">
<h2>CREATE MULTI-CLASS CLASSIFIERS REQUIREMENTS<a class="headerlink" href="#CREATE-MULTI-CLASS-CLASSIFIERS-REQUIREMENTS" title="Permalink to this heading"></a></h2>
<p>Some requirements for this to run succesfully (there is currently (10/23) no way of doing this in the GUI):</p>
<p><strong>(1)</strong> All files inside the <code class="docutils literal notranslate"><span class="pre">project_folder/csv/targets_inserted</span></code> directory contains an annotation column which name represent a class of mutually exclusive behaviors and values that map to different types of that behaviour class.</p>
<p>For example, the column may be named “Running”, and each row contains a value between 0 and 3, where 0 represents “no running”, 1 represent “slow speed running”, 2 represents “medium speed running”, and 3 represents “fast speed running”.</p>
<p><strong>(2)</strong> If creating a single classifier, the SimBA project_config.ini needs to contain a map pairing the values in the annotation column to behavior names. In the [SML Setting], insert a <code class="docutils literal notranslate"><span class="pre">classifier_map_1</span></code> option. See <a class="reference external" href="https://github.com/sgoldenlab/simba/blob/master/docs/multiclass_project_config.ini">THIS</a> config file as an example. For example, the [SML Settings] may read:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[SML settings]
model_dir = /Users/simon/Desktop/envs/troubleshooting/multilabel/models
model_path_1 = /Users/simon/Desktop/envs/troubleshooting/multilabel/models/generated_models/syllable_class.sav
no_targets = 1
target_name_1 = running
classifier_map_1 = {0: &#39;no running&#39;, 1: &#39;slow speed running&#39;, 2: &#39;medium speed running&#39;, 3: &#39;fast speed running&#39;}
</pre></div>
</div>
<p><strong>(3)</strong> If creating multiple multi-class classifiers, the SimBA meta files inside the <code class="docutils literal notranslate"><span class="pre">project_folder/configs</span></code> directory needs to contain a map pairing the values in the annotation column to behavior names. This involves inserting a column named <code class="docutils literal notranslate"><span class="pre">classifier_map</span></code> and the map into the first row. See last column in <a class="reference external" href="https://github.com/sgoldenlab/simba/blob/master/misc/multiclass_meta.csv">THIS</a> config meta file as an example.</p>
<p><strong>(4)</strong> We can use sampling to balance the class distributions of annoatated frames when creating classifiers.</p>
<ul>
<li><p>When creating a single classifier: Open the <code class="docutils literal notranslate"><span class="pre">project_config.ini</span></code> in a text editor. Under the [create ensemble settings] section find the [under_sample_setting] section and set this to either <code class="docutils literal notranslate"><span class="pre">random</span> <span class="pre">undersample</span> <span class="pre">multiclass</span> <span class="pre">frames</span></code> or <code class="docutils literal notranslate"><span class="pre">random</span> <span class="pre">undersample</span> <span class="pre">multiclass</span> <span class="pre">bouts</span></code>. Next, under the [create ensemble settings] section and [under_sample_ratio] section, set this to a dictionary that defines a baseline target class, and ratios to sample of the non-target classes relative to the target
class. For example, this is a valid entry: {‘target_var’: 0, ‘sampling_ratio’: {1: 1.0, 2: 1.0, 3: 1.0}}.</p>
<p>Example I: You have 4 classes of behaviors 0 represents “no running”, 1 represent “slow speed running”, 2 represents “medium speed running”, and 3 represents “fast speed running”. You have 100 annotated frames of no running, 500 annotated frames each of “slow speed running”, “medium speed running”, and “fast speed running”. Now you want to sample as many annotations in each class as in there is in the “no running class” for training.</p>
<p>Set the target_var to zero (no running) and the sampling ratios to 1.0 for each of the other classes: {‘target_var’: 0, ‘sampling_ratio’: {1: 1.0, 2: 1.0, 3: 1.0}}. For each of the non-target classes (1, 2, 3), 100% of the count of annotations in the target class (0) will be sampled.</p>
<p>Example II: You have 100 annotated frames of no running, 500 annotated frames each of “slow speed running”, “medium speed running”, and “fast speed running”. Now you want half the numer of annotations present in the non-running class for all the non-target classes. Set the target_var to zero (no running) and the sampling ratios to 0.5 for each of the non-target classes: {‘target_var’: 0, ‘sampling_ratio’: {1: 0.5, 2: 0.5, 3: 0.5}}. For each of the non-target classes (1, 2, 3), 50% of the
count of annotations in the target class (0) will be sampled.</p>
<p>Here is example config file undersample setting for a multiclass task:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[create ensemble settings]
under_sample_setting = random undersample multiclass frames
under_sample_ratio = {&#39;target_var&#39;: 0, &#39;sampling_ratio&#39;: {1: 1, 2: 1, 3: 1}}
</pre></div>
</div>
</li>
<li><p>When creating multiple classifiers: Open the files in the <code class="docutils literal notranslate"><span class="pre">project_folder/configs</span></code> directory in a text editor.</p>
<p>Under the <code class="docutils literal notranslate"><span class="pre">under_sample_setting</span></code> header insert either<code class="docutils literal notranslate"><span class="pre">random</span> <span class="pre">undersample</span> <span class="pre">multiclass</span> <span class="pre">frames</span></code> or <code class="docutils literal notranslate"><span class="pre">random</span> <span class="pre">undersample</span> <span class="pre">multiclass</span> <span class="pre">bouts</span></code>. Under the <code class="docutils literal notranslate"><span class="pre">under_sample_ratio</span></code> header, insert your sampling ratios e.g., <code class="docutils literal notranslate"><span class="pre">{'target_var':</span> <span class="pre">0,</span> <span class="pre">'sampling_ratio':</span> <span class="pre">{1:</span> <span class="pre">1,</span> <span class="pre">2:</span> <span class="pre">1,</span> <span class="pre">3:</span> <span class="pre">1}}</span></code>.</p>
</li>
</ul>
<section id="CREATE-A-SINGLE-MULTI-CLASS-CLASSIFIER">
<h3>CREATE A SINGLE MULTI-CLASS CLASSIFIER<a class="headerlink" href="#CREATE-A-SINGLE-MULTI-CLASS-CLASSIFIER" title="Permalink to this heading"></a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#WE DEFINE THE PATH TO OUR SIMBA PROJECT CONFIG FILE</span>
<span class="n">CONFIG_PATH</span> <span class="o">=</span> <span class="s1">&#39;/Users/simon/Desktop/envs/troubleshooting/multilabel/project_folder/project_config.ini&#39;</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#WE CREATE A MULTI-CLASS TRAINER INSTANCE</span>
<span class="n">model_trainer</span> <span class="o">=</span> <span class="n">TrainMultiClassRandomForestClassifier</span><span class="p">(</span><span class="n">config_path</span><span class="o">=</span><span class="n">CONFIG_PATH</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Reading in 1 annotated files...
Reading complete 01.YC015YC016phase45-sample (elapsed time: 51.3581s)...
Number of features in dataset: 14251
Number of None frames in dataset: 10 (25.0%)
Number of sharp frames in dataset: 10 (25.0%)
Number of track frames in dataset: 10 (25.0%)
Number of sync frames in dataset: 10 (25.0%)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#WE RUN THIS MODEL TRAINER INSTANCE</span>
<span class="n">model_trainer</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Training and evaluating model...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
[Parallel(n_jobs=-1)]: Using backend ThreadingBackend with 8 concurrent workers.
[Parallel(n_jobs=-1)]: Done   6 out of  10 | elapsed:    0.0s remaining:    0.0s
[Parallel(n_jobs=-1)]: Done  10 out of  10 | elapsed:    0.0s finished
[Parallel(n_jobs=-1)]: Using backend ThreadingBackend with 8 concurrent workers.
[Parallel(n_jobs=-1)]: Using backend ThreadingBackend with 8 concurrent workers.
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Calculating learning curves...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
[Parallel(n_jobs=-1)]: Using backend ThreadingBackend with 8 concurrent workers.
[Parallel(n_jobs=-1)]: Using backend ThreadingBackend with 8 concurrent workers.
[Parallel(n_jobs=-1)]: Using backend ThreadingBackend with 8 concurrent workers.
[Parallel(n_jobs=-1)]: Using backend ThreadingBackend with 8 concurrent workers.
[Parallel(n_jobs=-1)]: Using backend ThreadingBackend with 8 concurrent workers.
[Parallel(n_jobs=-1)]: Done   6 out of  10 | elapsed:    0.1s remaining:    0.1s
[Parallel(n_jobs=-1)]: Done   6 out of  10 | elapsed:    0.1s remaining:    0.1s
[Parallel(n_jobs=-1)]: Done  10 out of  10 | elapsed:    0.1s finished
[Parallel(n_jobs=-1)]: Done  10 out of  10 | elapsed:    0.1s finished
[Parallel(n_jobs=-1)]: Done   6 out of  10 | elapsed:    0.1s remaining:    0.0s
[Parallel(n_jobs=8)]: Using backend ThreadingBackend with 8 concurrent workers.
[Parallel(n_jobs=8)]: Using backend ThreadingBackend with 8 concurrent workers.
[Parallel(n_jobs=-1)]: Done  10 out of  10 | elapsed:    0.1s finished
[Parallel(n_jobs=-1)]: Done   6 out of  10 | elapsed:    0.1s remaining:    0.1s
[Parallel(n_jobs=-1)]: Done   6 out of  10 | elapsed:    0.1s remaining:    0.1s
[Parallel(n_jobs=-1)]: Done   6 out of  10 | elapsed:    0.2s remaining:    0.1s
[Parallel(n_jobs=-1)]: Done   6 out of  10 | elapsed:    0.1s remaining:    0.1s
[Parallel(n_jobs=-1)]: Done  10 out of  10 | elapsed:    0.2s finished
[Parallel(n_jobs=-1)]: Done  10 out of  10 | elapsed:    0.1s finished
[Parallel(n_jobs=-1)]: Done  10 out of  10 | elapsed:    0.1s finished
[Parallel(n_jobs=-1)]: Done  10 out of  10 | elapsed:    0.1s finished
[Parallel(n_jobs=8)]: Done   6 out of  10 | elapsed:    0.0s remaining:    0.0s
[Parallel(n_jobs=8)]: Done  10 out of  10 | elapsed:    0.0s finished
[Parallel(n_jobs=8)]: Done   6 out of  10 | elapsed:    0.0s remaining:    0.0s
[Parallel(n_jobs=8)]: Done  10 out of  10 | elapsed:    0.0s finished
[Parallel(n_jobs=8)]: Using backend ThreadingBackend with 8 concurrent workers.
[Parallel(n_jobs=8)]: Using backend ThreadingBackend with 8 concurrent workers.
[Parallel(n_jobs=8)]: Using backend ThreadingBackend with 8 concurrent workers.
[Parallel(n_jobs=8)]: Using backend ThreadingBackend with 8 concurrent workers.
[Parallel(n_jobs=8)]: Using backend ThreadingBackend with 8 concurrent workers.
[Parallel(n_jobs=8)]: Done   6 out of  10 | elapsed:    0.0s remaining:    0.0s
[Parallel(n_jobs=8)]: Done   6 out of  10 | elapsed:    0.0s remaining:    0.0s
[Parallel(n_jobs=8)]: Done   6 out of  10 | elapsed:    0.0s remaining:    0.0s
[Parallel(n_jobs=8)]: Done  10 out of  10 | elapsed:    0.0s finished
[Parallel(n_jobs=8)]: Done  10 out of  10 | elapsed:    0.0s finished
[Parallel(n_jobs=8)]: Done  10 out of  10 | elapsed:    0.0s finished
[Parallel(n_jobs=8)]: Done   6 out of  10 | elapsed:    0.0s remaining:    0.0s
[Parallel(n_jobs=8)]: Done  10 out of  10 | elapsed:    0.0s finished
[Parallel(n_jobs=8)]: Done   6 out of  10 | elapsed:    0.0s remaining:    0.0s
[Parallel(n_jobs=8)]: Done  10 out of  10 | elapsed:    0.0s finished
[Parallel(n_jobs=8)]: Using backend ThreadingBackend with 8 concurrent workers.
[Parallel(n_jobs=8)]: Using backend ThreadingBackend with 8 concurrent workers.
[Parallel(n_jobs=8)]: Done   6 out of  10 | elapsed:    0.0s remaining:    0.0s
[Parallel(n_jobs=8)]: Done  10 out of  10 | elapsed:    0.0s finished
[Parallel(n_jobs=8)]: Done   6 out of  10 | elapsed:    0.0s remaining:    0.0s
[Parallel(n_jobs=8)]: Done  10 out of  10 | elapsed:    0.0s finished
[Parallel(n_jobs=8)]: Using backend ThreadingBackend with 8 concurrent workers.
[Parallel(n_jobs=8)]: Using backend ThreadingBackend with 8 concurrent workers.
[Parallel(n_jobs=8)]: Using backend ThreadingBackend with 8 concurrent workers.
[Parallel(n_jobs=8)]: Using backend ThreadingBackend with 8 concurrent workers.
[Parallel(n_jobs=8)]: Using backend ThreadingBackend with 8 concurrent workers.
[Parallel(n_jobs=8)]: Done   6 out of  10 | elapsed:    0.0s remaining:    0.0s
[Parallel(n_jobs=8)]: Done  10 out of  10 | elapsed:    0.0s finished
[Parallel(n_jobs=8)]: Done   6 out of  10 | elapsed:    0.0s remaining:    0.0s
[Parallel(n_jobs=8)]: Done  10 out of  10 | elapsed:    0.0s finished
[Parallel(n_jobs=8)]: Done   6 out of  10 | elapsed:    0.0s remaining:    0.0s
[Parallel(n_jobs=-1)]: Using backend ThreadingBackend with 8 concurrent workers.
[Parallel(n_jobs=8)]: Done  10 out of  10 | elapsed:    0.0s finished
[Parallel(n_jobs=-1)]: Using backend ThreadingBackend with 8 concurrent workers.
[Parallel(n_jobs=8)]: Done   6 out of  10 | elapsed:    0.1s remaining:    0.0s
[Parallel(n_jobs=8)]: Done  10 out of  10 | elapsed:    0.1s finished
[Parallel(n_jobs=8)]: Done   6 out of  10 | elapsed:    0.1s remaining:    0.0s
[Parallel(n_jobs=8)]: Done  10 out of  10 | elapsed:    0.1s finished
[Parallel(n_jobs=-1)]: Done   6 out of  10 | elapsed:    0.0s remaining:    0.0s
[Parallel(n_jobs=-1)]: Done   6 out of  10 | elapsed:    0.0s remaining:    0.0s
[Parallel(n_jobs=-1)]: Done  10 out of  10 | elapsed:    0.0s finished
[Parallel(n_jobs=-1)]: Done  10 out of  10 | elapsed:    0.0s finished
[Parallel(n_jobs=-1)]: Using backend ThreadingBackend with 8 concurrent workers.
[Parallel(n_jobs=-1)]: Using backend ThreadingBackend with 8 concurrent workers.
[Parallel(n_jobs=-1)]: Using backend ThreadingBackend with 8 concurrent workers.
[Parallel(n_jobs=8)]: Using backend ThreadingBackend with 8 concurrent workers.
[Parallel(n_jobs=8)]: Using backend ThreadingBackend with 8 concurrent workers.
[Parallel(n_jobs=-1)]: Using backend ThreadingBackend with 8 concurrent workers.
[Parallel(n_jobs=-1)]: Using backend ThreadingBackend with 8 concurrent workers.
[Parallel(n_jobs=-1)]: Done   6 out of  10 | elapsed:    0.1s remaining:    0.1s
[Parallel(n_jobs=-1)]: Done  10 out of  10 | elapsed:    0.1s finished
[Parallel(n_jobs=8)]: Done   6 out of  10 | elapsed:    0.1s remaining:    0.0s
[Parallel(n_jobs=8)]: Done   6 out of  10 | elapsed:    0.1s remaining:    0.0s
[Parallel(n_jobs=-1)]: Done   6 out of  10 | elapsed:    0.1s remaining:    0.1s
[Parallel(n_jobs=8)]: Done  10 out of  10 | elapsed:    0.1s finished
[Parallel(n_jobs=8)]: Done  10 out of  10 | elapsed:    0.1s finished
[Parallel(n_jobs=-1)]: Done  10 out of  10 | elapsed:    0.1s finished
[Parallel(n_jobs=-1)]: Done   6 out of  10 | elapsed:    0.1s remaining:    0.1s
[Parallel(n_jobs=-1)]: Done   6 out of  10 | elapsed:    0.1s remaining:    0.0s
[Parallel(n_jobs=-1)]: Done   6 out of  10 | elapsed:    0.1s remaining:    0.1s
[Parallel(n_jobs=-1)]: Done  10 out of  10 | elapsed:    0.1s finished
[Parallel(n_jobs=-1)]: Done  10 out of  10 | elapsed:    0.2s finished
[Parallel(n_jobs=-1)]: Done  10 out of  10 | elapsed:    0.1s finished
[Parallel(n_jobs=8)]: Using backend ThreadingBackend with 8 concurrent workers.
[Parallel(n_jobs=8)]: Using backend ThreadingBackend with 8 concurrent workers.
[Parallel(n_jobs=8)]: Using backend ThreadingBackend with 8 concurrent workers.
[Parallel(n_jobs=8)]: Using backend ThreadingBackend with 8 concurrent workers.
[Parallel(n_jobs=8)]: Done   6 out of  10 | elapsed:    0.0s remaining:    0.0s
[Parallel(n_jobs=8)]: Using backend ThreadingBackend with 8 concurrent workers.
[Parallel(n_jobs=8)]: Done  10 out of  10 | elapsed:    0.0s finished
[Parallel(n_jobs=8)]: Using backend ThreadingBackend with 8 concurrent workers.
[Parallel(n_jobs=8)]: Done   6 out of  10 | elapsed:    0.1s remaining:    0.0s
[Parallel(n_jobs=8)]: Using backend ThreadingBackend with 8 concurrent workers.
[Parallel(n_jobs=8)]: Done  10 out of  10 | elapsed:    0.1s finished
[Parallel(n_jobs=8)]: Done   6 out of  10 | elapsed:    0.1s remaining:    0.0s
[Parallel(n_jobs=8)]: Done  10 out of  10 | elapsed:    0.1s finished
[Parallel(n_jobs=8)]: Done   6 out of  10 | elapsed:    0.0s remaining:    0.0s
[Parallel(n_jobs=8)]: Done   6 out of  10 | elapsed:    0.0s remaining:    0.0s
[Parallel(n_jobs=8)]: Done  10 out of  10 | elapsed:    0.0s finished
[Parallel(n_jobs=8)]: Done   6 out of  10 | elapsed:    0.0s remaining:    0.0s
[Parallel(n_jobs=8)]: Done  10 out of  10 | elapsed:    0.0s finished
[Parallel(n_jobs=8)]: Done   6 out of  10 | elapsed:    0.0s remaining:    0.0s
[Parallel(n_jobs=8)]: Done  10 out of  10 | elapsed:    0.0s finished
[Parallel(n_jobs=8)]: Done  10 out of  10 | elapsed:    0.0s finished
[Parallel(n_jobs=8)]: Using backend ThreadingBackend with 8 concurrent workers.
[Parallel(n_jobs=8)]: Using backend ThreadingBackend with 8 concurrent workers.
[Parallel(n_jobs=8)]: Using backend ThreadingBackend with 8 concurrent workers.
[Parallel(n_jobs=8)]: Done   6 out of  10 | elapsed:    0.0s remaining:    0.0s
[Parallel(n_jobs=8)]: Done  10 out of  10 | elapsed:    0.0s finished
[Parallel(n_jobs=8)]: Done   6 out of  10 | elapsed:    0.0s remaining:    0.0s
[Parallel(n_jobs=8)]: Done  10 out of  10 | elapsed:    0.0s finished
[Parallel(n_jobs=8)]: Done   6 out of  10 | elapsed:    0.0s remaining:    0.0s
[Parallel(n_jobs=8)]: Done  10 out of  10 | elapsed:    0.0s finished
[Parallel(n_jobs=8)]: Using backend ThreadingBackend with 8 concurrent workers.
[Parallel(n_jobs=8)]: Using backend ThreadingBackend with 8 concurrent workers.
[Parallel(n_jobs=-1)]: Using backend ThreadingBackend with 8 concurrent workers.
[Parallel(n_jobs=8)]: Done   6 out of  10 | elapsed:    0.0s remaining:    0.0s
[Parallel(n_jobs=8)]: Done  10 out of  10 | elapsed:    0.0s finished
[Parallel(n_jobs=8)]: Done   6 out of  10 | elapsed:    0.0s remaining:    0.0s
[Parallel(n_jobs=8)]: Done  10 out of  10 | elapsed:    0.0s finished
[Parallel(n_jobs=-1)]: Done   6 out of  10 | elapsed:    0.0s remaining:    0.0s
[Parallel(n_jobs=-1)]: Done  10 out of  10 | elapsed:    0.0s finished
[Parallel(n_jobs=8)]: Using backend ThreadingBackend with 8 concurrent workers.
[Parallel(n_jobs=8)]: Done   6 out of  10 | elapsed:    0.0s remaining:    0.0s
[Parallel(n_jobs=8)]: Done  10 out of  10 | elapsed:    0.0s finished
[Parallel(n_jobs=8)]: Using backend ThreadingBackend with 8 concurrent workers.
[Parallel(n_jobs=8)]: Done   6 out of  10 | elapsed:    0.0s remaining:    0.0s
[Parallel(n_jobs=8)]: Done  10 out of  10 | elapsed:    0.0s finished
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Learning curve calculation complete (elapsed time: 1.5253s) ...
Calculating PR curves...
Precision-recall curve calculation complete (elapsed time: 0.1334s) ...
Creating classification report visualization...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
[Parallel(n_jobs=8)]: Using backend ThreadingBackend with 8 concurrent workers.
[Parallel(n_jobs=8)]: Done   6 out of  10 | elapsed:    0.0s remaining:    0.0s
[Parallel(n_jobs=8)]: Done  10 out of  10 | elapsed:    0.0s finished
[Parallel(n_jobs=8)]: Using backend ThreadingBackend with 8 concurrent workers.
[Parallel(n_jobs=8)]: Done   6 out of  10 | elapsed:    0.0s remaining:    0.0s
[Parallel(n_jobs=8)]: Done  10 out of  10 | elapsed:    0.0s finished
[Parallel(n_jobs=8)]: Using backend ThreadingBackend with 8 concurrent workers.
[Parallel(n_jobs=8)]: Done   6 out of  10 | elapsed:    0.0s remaining:    0.0s
[Parallel(n_jobs=8)]: Done  10 out of  10 | elapsed:    0.0s finished
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Creating feature importance log...
Creating feature importance bar chart...
Creating feature importance log...
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># FINALLY WE SAVE THE MODEL</span>
<span class="n">model_trainer</span><span class="o">.</span><span class="n">save_model</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
SIMBA COMPLETE: Classifier syllable_class saved in models/generated_models directory (elapsed time: 8.938s)     complete
SIMBA COMPLETE: Evaluation files are in models/generated_models/model_evaluations folders       complete
</pre></div></div>
</div>
</section>
<section id="CREATE-MULTIPLE-MULTI-CLASS-CLASSIFIER,-ONE-FOR-EACH-FILE-INSIDE-THE-PROJECT_FOLDER/CONFIGS-DIRECTORY">
<h3>CREATE MULTIPLE MULTI-CLASS CLASSIFIER, ONE FOR EACH FILE INSIDE THE PROJECT_FOLDER/CONFIGS DIRECTORY<a class="headerlink" href="#CREATE-MULTIPLE-MULTI-CLASS-CLASSIFIER,-ONE-FOR-EACH-FILE-INSIDE-THE-PROJECT_FOLDER/CONFIGS-DIRECTORY" title="Permalink to this heading"></a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#WE CREATE A GRID-SEARCH MULTI-CLASS TRAINER INSTANCE</span>
<span class="n">multi_model_trainer</span> <span class="o">=</span> <span class="n">GridSearchMulticlassRandomForestClassifier</span><span class="p">(</span><span class="n">config_path</span><span class="o">=</span><span class="n">CONFIG_PATH</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Reading in 1 annotated files...
SIMBA WARNING: MultiProcessingFailedWarning: Multi-processing file read failed, reverting to single core (increased run-time on large datasets).        warning
Reading in file 1/1...
Dataset size: 2.28352MB / 0.002284GB
1 file(s) read (elapsed time: 52.359s) ...
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#WE RUN THIS MODEL TRAINER INSTANCE</span>
<span class="n">multi_model_trainer</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Training model 1/2 (syllable_class)...
Number of features in dataset: 14251
Number of None frames in dataset: 10 (25.0%)
Number of sharp frames in dataset: 10 (25.0%)
Number of track frames in dataset: 10 (25.0%)
Number of sync frames in dataset: 10 (25.0%)
MODEL 1 settings
+------------------------+----------------+
| Setting                | value          |
+========================+================+
| Model name             | syllable_class |
+------------------------+----------------+
| Ensemble method        | RF             |
+------------------------+----------------+
| Estimators (trees)     | 2000           |
+------------------------+----------------+
| Max features           | sqrt           |
+------------------------+----------------+
| Under sampling setting | None           |
+------------------------+----------------+
| Under sampling ratio   | nan            |
+------------------------+----------------+
| Over sampling setting  | None           |
+------------------------+----------------+
| Over sampling ratio    | nan            |
+------------------------+----------------+
| criterion              | gini           |
+------------------------+----------------+
| Min sample leaf        | 1              |
+------------------------+----------------+     TABLE
Fitting syllable_class model...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
[Parallel(n_jobs=-1)]: Using backend ThreadingBackend with 8 concurrent workers.
[Parallel(n_jobs=-1)]: Done  34 tasks      | elapsed:    0.1s
[Parallel(n_jobs=-1)]: Done 184 tasks      | elapsed:    0.3s
[Parallel(n_jobs=-1)]: Done 434 tasks      | elapsed:    0.6s
[Parallel(n_jobs=-1)]: Done 784 tasks      | elapsed:    1.1s
[Parallel(n_jobs=-1)]: Done 1234 tasks      | elapsed:    1.7s
[Parallel(n_jobs=-1)]: Done 1784 tasks      | elapsed:    2.5s
[Parallel(n_jobs=-1)]: Done 2000 out of 2000 | elapsed:    2.7s finished
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Saving model meta data file...
Classifier syllable_class_0 saved in models/validations/model_files directory ...
SIMBA COMPLETE: All models and evaluations complete. The models and evaluation files are in models/validations folders  complete
Training model 2/2 (syllable_class)...
Number of features in dataset: 14251
Number of None frames in dataset: 10 (25.0%)
Number of sharp frames in dataset: 10 (25.0%)
Number of track frames in dataset: 10 (25.0%)
Number of sync frames in dataset: 10 (25.0%)
MODEL 2 settings
+------------------------+----------------+
| Setting                | value          |
+========================+================+
| Model name             | syllable_class |
+------------------------+----------------+
| Ensemble method        | RF             |
+------------------------+----------------+
| Estimators (trees)     | 2000           |
+------------------------+----------------+
| Max features           | sqrt           |
+------------------------+----------------+
| Under sampling setting | None           |
+------------------------+----------------+
| Under sampling ratio   | nan            |
+------------------------+----------------+
| Over sampling setting  | None           |
+------------------------+----------------+
| Over sampling ratio    | nan            |
+------------------------+----------------+
| criterion              | gini           |
+------------------------+----------------+
| Min sample leaf        | 1              |
+------------------------+----------------+     TABLE
Fitting syllable_class model...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
[Parallel(n_jobs=-1)]: Using backend ThreadingBackend with 8 concurrent workers.
[Parallel(n_jobs=-1)]: Done  34 tasks      | elapsed:    0.1s
[Parallel(n_jobs=-1)]: Done 184 tasks      | elapsed:    0.3s
[Parallel(n_jobs=-1)]: Done 434 tasks      | elapsed:    0.6s
[Parallel(n_jobs=-1)]: Done 784 tasks      | elapsed:    1.1s
[Parallel(n_jobs=-1)]: Done 1234 tasks      | elapsed:    1.7s
[Parallel(n_jobs=-1)]: Done 1784 tasks      | elapsed:    2.4s
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Saving model meta data file...
Classifier syllable_class_1 saved in models/validations/model_files directory ...
SIMBA COMPLETE: All models and evaluations complete. The models and evaluation files are in models/validations folders  complete
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
[Parallel(n_jobs=-1)]: Done 2000 out of 2000 | elapsed:    2.7s finished
</pre></div></div>
</div>
</section>
<section id="RUN-INFERENCE">
<h3>RUN INFERENCE<a class="headerlink" href="#RUN-INFERENCE" title="Permalink to this heading"></a></h3>
<p>Now when we have created our multi-class model(s), we want to use one model to create predictions for new videos. Set the path to the model you want to use in the [SML settings] section under the <code class="docutils literal notranslate"><span class="pre">model_path</span></code> option.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#WE CREATE A MULTI-CLASS BATCH INFERENCE INSTANCE</span>
<span class="n">batch_inferencer</span> <span class="o">=</span> <span class="n">InferenceMulticlassBatch</span><span class="p">(</span><span class="n">config_path</span><span class="o">=</span><span class="n">CONFIG_PATH</span><span class="p">)</span>
<br/></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Analyzing 1 file(s) with 1 classifier(s)...
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#WE RUN THE BATCH INFERENCE INSTANCE</span>
<span class="n">batch_inferencer</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Analyzing video 01.YC015YC016phase45-sample...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
[Parallel(n_jobs=8)]: Using backend ThreadingBackend with 8 concurrent workers.
[Parallel(n_jobs=8)]: Done   6 out of  10 | elapsed:    0.0s remaining:    0.0s
[Parallel(n_jobs=8)]: Done  10 out of  10 | elapsed:    0.0s finished
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Predictions created for 01.YC015YC016phase45-sample (elapsed time: 5046.467) ...
SIMBA COMPLETE: Multi-class machine predictions complete. 1 file(s) saved in project_folder/csv/machine_results directory (elapsed time: 5046.4743s)    complete
</pre></div></div>
</div>
<p>After running <code class="docutils literal notranslate"><span class="pre">batch_inferencer.run()</span></code> in directly above cell, the results are saved in the <code class="docutils literal notranslate"><span class="pre">project_folder/csv/machine_results</span></code> directory of the SimBA project. Rather than the one-column-per-classifier created by Boolean classifiers, you will have one column per type of behavior in you classifier map. These fields contain probabilities that each of the behaviors occur in each frame (you may potentially want to weigh these scores to get the most accurate results).</p>
</section>
<section id="VISUALIZE-RESULTS">
<h3>VISUALIZE RESULTS<a class="headerlink" href="#VISUALIZE-RESULTS" title="Permalink to this heading"></a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#DEFINE HOW YOU WANT TO PLOT THE RESULTS</span>
<span class="n">CREATE_FRAMES</span> <span class="o">=</span> <span class="kc">False</span>
<span class="n">CREATE_VIDEO</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">ROTATE_VIDEO</span> <span class="o">=</span> <span class="kc">False</span>
<span class="n">VIDEO_NAMES</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;01.YC015YC016phase45-sample.csv&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#WE CREATE A MULTI-CLASS PLOTTING INSTANCE</span>
<span class="n">multiclass_plotter</span> <span class="o">=</span> <span class="n">PlotMulticlassSklearnResultsSingleCore</span><span class="p">(</span><span class="n">config_path</span><span class="o">=</span><span class="n">CONFIG_PATH</span><span class="p">,</span>
                                                            <span class="n">frame_setting</span><span class="o">=</span><span class="n">CREATE_FRAMES</span><span class="p">,</span>
                                                            <span class="n">video_setting</span><span class="o">=</span><span class="n">CREATE_VIDEO</span><span class="p">,</span>
                                                            <span class="n">video_names</span><span class="o">=</span><span class="n">VIDEO_NAMES</span><span class="p">,</span>
                                                            <span class="n">rotate</span><span class="o">=</span><span class="n">ROTATE_VIDEO</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#WE RUN THE PLOTTER (ONLY WORKS ON SINGLE CORE AT MOMENT SO MIGHT TAKE SOME TIME)</span>
<span class="n">multiclass_plotter</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
SIMBA WARNING: FrameRangeWarning: The video /Users/simon/Desktop/envs/troubleshooting/multilabel/project_folder/videos/01.YC015YC016phase45-sample.mp4 contains 300 frames, while the data /Users/simon/Desktop/envs/troubleshooting/multilabel/project_folder/csv/machine_results/01.YC015YC016phase45-sample.csv contains 40 frames.  warning
Frame: 1 / 300. Video: 01.YC015YC016phase45-sample (1/1)
Frame: 2 / 300. Video: 01.YC015YC016phase45-sample (1/1)
Frame: 3 / 300. Video: 01.YC015YC016phase45-sample (1/1)
Frame: 4 / 300. Video: 01.YC015YC016phase45-sample (1/1)
Frame: 5 / 300. Video: 01.YC015YC016phase45-sample (1/1)
Frame: 6 / 300. Video: 01.YC015YC016phase45-sample (1/1)
Frame: 7 / 300. Video: 01.YC015YC016phase45-sample (1/1)
Frame: 8 / 300. Video: 01.YC015YC016phase45-sample (1/1)
Frame: 9 / 300. Video: 01.YC015YC016phase45-sample (1/1)
Frame: 10 / 300. Video: 01.YC015YC016phase45-sample (1/1)
Frame: 11 / 300. Video: 01.YC015YC016phase45-sample (1/1)
Frame: 12 / 300. Video: 01.YC015YC016phase45-sample (1/1)
Frame: 13 / 300. Video: 01.YC015YC016phase45-sample (1/1)
Frame: 14 / 300. Video: 01.YC015YC016phase45-sample (1/1)
Frame: 15 / 300. Video: 01.YC015YC016phase45-sample (1/1)
Frame: 16 / 300. Video: 01.YC015YC016phase45-sample (1/1)
Frame: 17 / 300. Video: 01.YC015YC016phase45-sample (1/1)
Frame: 18 / 300. Video: 01.YC015YC016phase45-sample (1/1)
Frame: 19 / 300. Video: 01.YC015YC016phase45-sample (1/1)
Frame: 20 / 300. Video: 01.YC015YC016phase45-sample (1/1)
Frame: 21 / 300. Video: 01.YC015YC016phase45-sample (1/1)
Frame: 22 / 300. Video: 01.YC015YC016phase45-sample (1/1)
Frame: 23 / 300. Video: 01.YC015YC016phase45-sample (1/1)
Frame: 24 / 300. Video: 01.YC015YC016phase45-sample (1/1)
Frame: 25 / 300. Video: 01.YC015YC016phase45-sample (1/1)
Frame: 26 / 300. Video: 01.YC015YC016phase45-sample (1/1)
Frame: 27 / 300. Video: 01.YC015YC016phase45-sample (1/1)
Frame: 28 / 300. Video: 01.YC015YC016phase45-sample (1/1)
Frame: 29 / 300. Video: 01.YC015YC016phase45-sample (1/1)
Frame: 30 / 300. Video: 01.YC015YC016phase45-sample (1/1)
Frame: 31 / 300. Video: 01.YC015YC016phase45-sample (1/1)
Frame: 32 / 300. Video: 01.YC015YC016phase45-sample (1/1)
Frame: 33 / 300. Video: 01.YC015YC016phase45-sample (1/1)
Frame: 34 / 300. Video: 01.YC015YC016phase45-sample (1/1)
Frame: 35 / 300. Video: 01.YC015YC016phase45-sample (1/1)
Frame: 36 / 300. Video: 01.YC015YC016phase45-sample (1/1)
Frame: 37 / 300. Video: 01.YC015YC016phase45-sample (1/1)
Frame: 38 / 300. Video: 01.YC015YC016phase45-sample (1/1)
Frame: 39 / 300. Video: 01.YC015YC016phase45-sample (1/1)
Frame: 40 / 300. Video: 01.YC015YC016phase45-sample (1/1)
SIMBA WARNING: FrameRangeWarning: Video terminated early: no data for frame 40 found in file /Users/simon/Desktop/envs/troubleshooting/multilabel/project_folder/csv/machine_results/01.YC015YC016phase45-sample.csv    warning
</pre></div></div>
</div>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="import_sleap_h5.html" class="btn btn-neutral float-left" title="Import SLEAP H5 files" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../tutorials.html" class="btn btn-neutral float-right" title="Tutorials" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, sronilsson.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>
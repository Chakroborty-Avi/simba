<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>GPU operations &mdash; SimBA 0.0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css" />
      <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
      <link rel="stylesheet" type="text/css" href="_static/css/simba_theme.css" />
      <link rel="stylesheet" type="text/css" href="_static/custom.css" />

  
    <link rel="shortcut icon" href="_static/readthedocs_logo.png"/>
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
        <script>let toggleHintShow = 'Click to show';</script>
        <script>let toggleHintHide = 'Click to hide';</script>
        <script>let toggleOpenOnPrint = 'true';</script>
        <script src="_static/togglebutton.js"></script>
        <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Notebooks" href="notebooks.html" />
    <link rel="prev" title="Video processors" href="simba.video_processors.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            SimBA
              <img src="_static/readthedocs_logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">API REFERENCE:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="api.html">API Reference</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">NOTEBOOKS:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="notebooks.html">Notebooks</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">USER GUIDE / TUTORIALS:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="tutorials.html">Tutorials</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">WALKTHROUGHS:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="walkthroughs.html">Walkthroughs</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">LABELLING TUTORIALS:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="labelling.html">Labelling</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">FAQ:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="tutorials_rst/FAQ.html">Friendly Asked Questions (FAQ)</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">DOCS:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="docs/workflow.html">SimBA basic workflow</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">ABOUT:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="credits.html">Credits</a></li>
<li class="toctree-l1"><a class="reference internal" href="credits.html#who-writes-this-stuff">Who writes this stuff??</a></li>
<li class="toctree-l1"><a class="reference internal" href="links.html">Links</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">SimBA</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="api.html">API Reference</a></li>
      <li class="breadcrumb-item active">GPU operations</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/simba.gpu_helpers.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<section id="gpu-operations">
<h1>GPU operations<a class="headerlink" href="#gpu-operations" title="Permalink to this heading"></a></h1>
<p>Methods for performing image, classification, and data transformations on the GPU</p>
<section id="module-simba.data_processors.cuda.geometry">
<span id="geometry"></span><h2>Geometry<a class="headerlink" href="#module-simba.data_processors.cuda.geometry" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="simba.data_processors.cuda.geometry.get_convex_hull">
<span class="sig-prename descclassname"><span class="pre">simba.data_processors.cuda.geometry.</span></span><span class="sig-name descname"><span class="pre">get_convex_hull</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pts</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/simba/data_processors/cuda/geometry.html#get_convex_hull"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#simba.data_processors.cuda.geometry.get_convex_hull" title="Permalink to this definition"></a></dt>
<dd><p>Compute the convex hull for each set of 2D points in parallel using CUDA and the Jarvis March algorithm.
This function processes a batch of 2D point sets (frames) and computes the convex hull for each set. The convex hull of a set of points is the smallest convex polygon that contains all the points.</p>
<p>The function uses a variant of the Gift Wrapping algorithm (Jarvis March) to compute the convex hull. It finds the leftmost point, then iteratively determines the next point on the hull by checking the orientation of the remaining points. The results are stored in the <cite>results</cite> array, where each row corresponds to a frame and contains the indices of the points forming the convex hull. Points not on the hull are marked with <cite>-1</cite>.</p>
<table class="simba-table docutils align-center">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>EXPECTED RUNTIMES</p></th>
<th class="head"></th>
</tr>
<tr class="row-even"><th class="head"><p>FRAMES</p></th>
<th class="head"><p>TIME (S)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p><strong>110k</strong></p></td>
<td><p>0.009</p></td>
</tr>
<tr class="row-even"><td><p><strong>181k</strong></p></td>
<td><p>0.014</p></td>
</tr>
<tr class="row-odd"><td><p><strong>327k</strong></p></td>
<td><p>0.026</p></td>
</tr>
<tr class="row-even"><td><p><strong>620k</strong></p></td>
<td><p>0.049</p></td>
</tr>
<tr class="row-odd"><td><p><strong>1.2m</strong></p></td>
<td><p>0.095</p></td>
</tr>
<tr class="row-even"><td><p><strong>2.4m</strong></p></td>
<td><p>0.18</p></td>
</tr>
<tr class="row-odd"><td><p><strong>4.7m</strong></p></td>
<td><p>0.351</p></td>
</tr>
<tr class="row-even"><td><p><strong>9m</strong></p></td>
<td><p>0.865</p></td>
</tr>
<tr class="row-odd"><td><p><strong>17.9m</strong></p></td>
<td><p>1.452</p></td>
</tr>
<tr class="row-even"><td><p><strong>35.8m</strong></p></td>
<td><p>5.695</p></td>
</tr>
<tr class="row-odd"><td><p><strong>71.6m</strong></p></td>
<td><p>7.243</p></td>
</tr>
<tr class="row-even"><td><p>NVIDIA GeForce RTX 4070</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>7 body-parts</p></td>
<td></td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference external" href="https://github.com/jhultman/rotating-calipers">Modified from Jacob Hultman</a></p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>pts</strong> – A 3D numpy array of shape (M, N, 2) where: - M is the number of frames. - N is the number of points (body-parts) in each frame. - The last dimension (2) represents the x and y coordinates of each point.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>An upated 3D numpy array of shape (M, N, 2) consisting of the points in the hull.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
<dt class="field-even">Example<span class="colon">:</span></dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">video_path</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;/mnt/c/troubleshooting/mitra/project_folder/videos/501_MA142_Gi_CNO_0514.mp4&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data_path</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;/mnt/c/troubleshooting/mitra/project_folder/csv/outlier_corrected_movement_location/501_MA142_Gi_CNO_0514 - test.csv&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">read_df</span><span class="p">(</span><span class="n">file_path</span><span class="o">=</span><span class="n">data_path</span><span class="p">,</span> <span class="n">file_type</span><span class="o">=</span><span class="s1">&#39;csv&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">frame_data</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">),</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">get_convex_hull</span><span class="p">(</span><span class="n">frame_data</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="simba.data_processors.cuda.geometry.is_inside_circle">
<span class="sig-prename descclassname"><span class="pre">simba.data_processors.cuda.geometry.</span></span><span class="sig-name descname"><span class="pre">is_inside_circle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><span class="pre">float</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/simba/data_processors/cuda/geometry.html#is_inside_circle"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#simba.data_processors.cuda.geometry.is_inside_circle" title="Permalink to this definition"></a></dt>
<dd><p>Determines whether points in array <cite>x</cite> are inside the rectangle defined by the top left and bottom right vertices in array <cite>y</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>np.ndarray</em>) – 2d numeric np.ndarray size (N, 2).</p></li>
<li><p><strong>y</strong> (<em>np.ndarray</em>) – 2d numeric np.ndarray size (2, 2) (top left[x, y], bottom right[x, y])</p></li>
</ul>
</dd>
<dt class="field-even">Return np.ndarray<span class="colon">:</span></dt>
<dd class="field-even"><p>2d numeric boolean (N, 1) with 1s representing the point being inside the rectangle and 0 if the point is outside the rectangle.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="simba.data_processors.cuda.geometry.is_inside_polygon">
<span class="sig-prename descclassname"><span class="pre">simba.data_processors.cuda.geometry.</span></span><span class="sig-name descname"><span class="pre">is_inside_polygon</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/simba/data_processors/cuda/geometry.html#is_inside_polygon"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#simba.data_processors.cuda.geometry.is_inside_polygon" title="Permalink to this definition"></a></dt>
<dd><p>Determines whether points in array <cite>x</cite> are inside the polygon defined by the vertices in array <cite>y</cite>.</p>
<p>This function uses GPU acceleration to perform the point-in-polygon test. The points in <cite>x</cite> are tested against
the polygon defined by the vertices in <cite>y</cite>. The result is an array where each element indicates whether
the corresponding point is inside the polygon.</p>
<a class="reference internal image-reference" href="_images/is_inside_polygon_cuda.webp"><img alt="_images/is_inside_polygon_cuda.webp" class="align-center" src="_images/is_inside_polygon_cuda.webp" style="width: 500px;" /></a>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>np.ndarray</em>) – An array of shape (N, 2) where each row represents a point in 2D space. The points are checked against the polygon.</p></li>
<li><p><strong>y</strong> (<em>np.ndarray</em>) – An array of shape (M, 2) where each row represents a vertex of the polygon in 2D space.</p></li>
</ul>
</dd>
<dt class="field-even">Return np.ndarray<span class="colon">:</span></dt>
<dd class="field-even"><p>An array of shape (N,) where each element is 1 if the corresponding point in <cite>x</cite> is inside the polygon defined by <cite>y</cite>, and 0 otherwise.</p>
</dd>
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int8</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int8</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">results</span> <span class="o">=</span> <span class="n">is_inside_polygon</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="mi">1</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="simba.data_processors.cuda.geometry.is_inside_rectangle">
<span class="sig-prename descclassname"><span class="pre">simba.data_processors.cuda.geometry.</span></span><span class="sig-name descname"><span class="pre">is_inside_rectangle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/simba/data_processors/cuda/geometry.html#is_inside_rectangle"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#simba.data_processors.cuda.geometry.is_inside_rectangle" title="Permalink to this definition"></a></dt>
<dd><p>Determines whether points in array <cite>x</cite> are inside the rectangle defined by the top left and bottom right vertices in array <cite>y</cite>.</p>
<table class="simba-table docutils align-center">
<colgroup>
<col style="width: 10%" />
<col style="width: 45%" />
<col style="width: 45%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>EXPECTED RUNTIMES</p></th>
<th class="head"></th>
<th class="head"></th>
</tr>
<tr class="row-even"><th class="head"><p>FRAMES (MILLION)</p></th>
<th class="head"><p>CUDA JIT GPU (S)</p></th>
<th class="head"><p>NUMBA CPU TIME (S)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p><strong>2 million</strong></p></td>
<td><p>0.005</p></td>
<td><p>0.022</p></td>
</tr>
<tr class="row-even"><td><p><strong>4 million</strong></p></td>
<td><p>0.009</p></td>
<td><p>0.031</p></td>
</tr>
<tr class="row-odd"><td><p><strong>8 million</strong></p></td>
<td><p>0.016</p></td>
<td><p>0.097</p></td>
</tr>
<tr class="row-even"><td><p><strong>16 million</strong></p></td>
<td><p>0.028</p></td>
<td><p>0.199</p></td>
</tr>
<tr class="row-odd"><td><p><strong>32 million</strong></p></td>
<td><p>0.054</p></td>
<td><p>0.399</p></td>
</tr>
<tr class="row-even"><td><p><strong>64 million</strong></p></td>
<td><p>0.111</p></td>
<td><p>0.769</p></td>
</tr>
<tr class="row-odd"><td><p><strong>128 million</strong></p></td>
<td><p>0.33</p></td>
<td><p>1.3</p></td>
</tr>
<tr class="row-even"><td><p><strong>256 million</strong></p></td>
<td><p>0.666</p></td>
<td><p>2.531</p></td>
</tr>
<tr class="row-odd"><td><p><strong>512 million</strong></p></td>
<td><p>1.161</p></td>
<td><p>7.273</p></td>
</tr>
<tr class="row-even"><td><p><strong>1 billion</strong></p></td>
<td><p>3.828</p></td>
<td><p>13.342</p></td>
</tr>
<tr class="row-odd"><td><p>NVIDIA GeForce RTX 4070</p></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>np.ndarray</em>) – 2d numeric np.ndarray size (N, 2).</p></li>
<li><p><strong>y</strong> (<em>np.ndarray</em>) – 2d numeric np.ndarray size (2, 2) (top left[x, y], bottom right[x, y])</p></li>
</ul>
</dd>
<dt class="field-even">Return np.ndarray<span class="colon">:</span></dt>
<dd class="field-even"><p>2d numeric boolean (N, 1) with 1s representing the point being inside the rectangle and 0 if the point is outside the rectangle.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="simba.data_processors.cuda.geometry.poly_area">
<span class="sig-prename descclassname"><span class="pre">simba.data_processors.cuda.geometry.</span></span><span class="sig-name descname"><span class="pre">poly_area</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pixels_per_mm</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.12)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><span class="pre">float</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.12)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">5000000</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/simba/data_processors/cuda/geometry.html#poly_area"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#simba.data_processors.cuda.geometry.poly_area" title="Permalink to this definition"></a></dt>
<dd><p>Compute the area of a polygon using GPU acceleration.</p>
<p>This function calculates the area of polygons defined by sets of points in a 3D array.
Each 2D slice along the first dimension represents a polygon, with each row corresponding
to a point in the polygon and each column representing the x and y coordinates.</p>
<p>The computation is done in batches to handle large datasets efficiently.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – A 3D numpy array of shape (N, M, 2), where N is the number of polygons, M is the number of points per polygon, and 2 represents the x and y coordinates.</p></li>
<li><p><strong>pixels_per_mm</strong> – Optional scaling factor to convert the area from pixels squared  to square millimeters. Default is 1.0.</p></li>
<li><p><strong>batch_size</strong> – Optional batch size for processing the data in chunks to fit in memory. Default is 0.5e+7.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A 1D numpy array of shape (N,) containing the computed area of each polygon in square millimeters.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-simba.data_processors.cuda.statistics">
<span id="statistics"></span><h2>Statistics<a class="headerlink" href="#module-simba.data_processors.cuda.statistics" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="simba.data_processors.cuda.statistics.count_values_in_ranges">
<span class="sig-prename descclassname"><span class="pre">simba.data_processors.cuda.statistics.</span></span><span class="sig-name descname"><span class="pre">count_values_in_ranges</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/simba/data_processors/cuda/statistics.html#count_values_in_ranges"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#simba.data_processors.cuda.statistics.count_values_in_ranges" title="Permalink to this definition"></a></dt>
<dd><p>Counts the number of values in each feature within specified ranges for each row in a 2D array using CUDA.</p>
<a class="reference internal image-reference" href="_images/get_euclidean_distance_cuda.png"><img alt="_images/get_euclidean_distance_cuda.png" class="align-center" src="_images/get_euclidean_distance_cuda.png" style="width: 500px;" /></a>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>np.ndarray</em>) – 2d array with feature values.</p></li>
<li><p><strong>r</strong> (<em>np.ndarray</em>) – 2d array with lower and upper boundaries.</p></li>
</ul>
</dd>
<dt class="field-even">Return np.ndarray<span class="colon">:</span></dt>
<dd class="field-even"><p>2d array of size len(x) x len(r) with the counts of values in each feature range (inclusive).</p>
</dd>
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int8</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">11</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r_x</span> <span class="o">=</span> <span class="n">count_values_in_ranges</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">r</span><span class="o">=</span><span class="n">r</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="simba.data_processors.cuda.statistics.get_3pt_angle">
<span class="sig-prename descclassname"><span class="pre">simba.data_processors.cuda.statistics.</span></span><span class="sig-name descname"><span class="pre">get_3pt_angle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/simba/data_processors/cuda/statistics.html#get_3pt_angle"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#simba.data_processors.cuda.statistics.get_3pt_angle" title="Permalink to this definition"></a></dt>
<dd><p>Computes the angle formed by three points in 2D space for each corresponding row in the input arrays using
GPU. The points x, y, and z represent the coordinates of three points in space, and the angle is calculated
at point <cite>y</cite> between the line segments <cite>xy</cite> and <cite>yz</cite>.</p>
<a class="reference internal image-reference" href="_images/get_3pt_angle_cuda.png"><img alt="_images/get_3pt_angle_cuda.png" class="align-center" src="_images/get_3pt_angle_cuda.png" style="width: 500px;" /></a>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> – A numpy array of shape (n, 2) representing the first point (e.g., nose) coordinates.</p></li>
<li><p><strong>y</strong> – A numpy array of shape (n, 2) representing the second point (e.g., center) coordinates, where the angle is computed.</p></li>
<li><p><strong>z</strong> – A numpy array of shape (n, 2) representing the second point (e.g., center) coordinates, where the angle is computed.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A numpy array of shape (n, 1) containing the calculated angles (in degrees) for each row.</p>
</dd>
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">video_path</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;/mnt/c/troubleshooting/mitra/project_folder/videos/501_MA142_Gi_CNO_0514.mp4&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data_path</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;/mnt/c/troubleshooting/mitra/project_folder/csv/outlier_corrected_movement_location/501_MA142_Gi_CNO_0514 - test.csv&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">read_df</span><span class="p">(</span><span class="n">file_path</span><span class="o">=</span><span class="n">data_path</span><span class="p">,</span> <span class="n">file_type</span><span class="o">=</span><span class="s1">&#39;csv&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s1">&#39;Center_x&#39;</span><span class="p">,</span> <span class="s1">&#39;Center_y&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s1">&#39;Nose_x&#39;</span><span class="p">,</span> <span class="s1">&#39;Nose_y&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">z</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s1">&#39;Tail_base_x&#39;</span><span class="p">,</span> <span class="s1">&#39;Tail_base_y&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">angle_x</span> <span class="o">=</span> <span class="n">get_3pt_angle</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="n">z</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="simba.data_processors.cuda.statistics.get_euclidean_distance_cuda">
<span class="sig-prename descclassname"><span class="pre">simba.data_processors.cuda.statistics.</span></span><span class="sig-name descname"><span class="pre">get_euclidean_distance_cuda</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/simba/data_processors/cuda/statistics.html#get_euclidean_distance_cuda"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#simba.data_processors.cuda.statistics.get_euclidean_distance_cuda" title="Permalink to this definition"></a></dt>
<dd><p>Computes the Euclidean distance between two sets of points using CUDA for GPU acceleration.</p>
<a class="reference internal image-reference" href="_images/get_euclidean_distance_cuda.png"><img alt="_images/get_euclidean_distance_cuda.png" class="align-center" src="_images/get_euclidean_distance_cuda.png" style="width: 500px;" /></a>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>np.ndarray</em>) – A 2D array of shape (n, m) representing n points in m-dimensional space. Each row corresponds to a point.</p></li>
<li><p><strong>y</strong> (<em>np.ndarray</em>) – A 2D array of shape (n, m) representing n points in m-dimensional space. Each row corresponds to a point.</p></li>
</ul>
</dd>
<dt class="field-even">Return np.ndarray<span class="colon">:</span></dt>
<dd class="field-even"><p>A 1D array of shape (n,) where each element represents the Euclidean distance  between the corresponding points in <cite>x</cite> and <cite>y</cite>.</p>
</dd>
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">video_path</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;/mnt/c/troubleshooting/mitra/project_folder/videos/501_MA142_Gi_CNO_0514.mp4&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data_path</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;/mnt/c/troubleshooting/mitra/project_folder/csv/outlier_corrected_movement_location/501_MA142_Gi_CNO_0514 - test.csv&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">read_df</span><span class="p">(</span><span class="n">file_path</span><span class="o">=</span><span class="n">data_path</span><span class="p">,</span> <span class="n">file_type</span><span class="o">=</span><span class="s1">&#39;csv&#39;</span><span class="p">)[[</span><span class="s1">&#39;Center_x&#39;</span><span class="p">,</span> <span class="s1">&#39;Center_y&#39;</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shifted_df</span> <span class="o">=</span> <span class="n">FeatureExtractionMixin</span><span class="o">.</span><span class="n">create_shifted_df</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">shifted_df</span><span class="p">[[</span><span class="s1">&#39;Center_x&#39;</span><span class="p">,</span> <span class="s1">&#39;Center_y&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">shifted_df</span><span class="p">[[</span><span class="s1">&#39;Center_x_shifted&#39;</span><span class="p">,</span> <span class="s1">&#39;Center_y_shifted&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">get_euclidean_distance_cuda</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="simba.data_processors.cuda.statistics.get_euclidean_distance_cupy">
<span class="sig-prename descclassname"><span class="pre">simba.data_processors.cuda.statistics.</span></span><span class="sig-name descname"><span class="pre">get_euclidean_distance_cupy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.12)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">35000000007</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/simba/data_processors/cuda/statistics.html#get_euclidean_distance_cupy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#simba.data_processors.cuda.statistics.get_euclidean_distance_cupy" title="Permalink to this definition"></a></dt>
<dd><p>Computes the Euclidean distance between corresponding pairs of points in two 2D arrays
using CuPy for GPU acceleration. The computation is performed in batches to handle large
datasets efficiently.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>np.ndarray</em>) – A 2D NumPy array with shape (n, 2), where each row represents a point in a 2D space.</p></li>
<li><p><strong>y</strong> (<em>np.ndarray</em>) – A 2D NumPy array with shape (n, 2), where each row represents a point in a 2D space. The shape of <cite>y</cite> must match the shape of <cite>x</cite>.</p></li>
<li><p><strong>batch_size</strong> (<em>Optional</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a><em>]</em>) – The number of points to process in a single batch. This parameter controls memory usage and can be adjusted based on available GPU memory. The default value is large (<cite>3.5e10 + 7</cite>) to maximize GPU utilization, but it can be lowered if memory issues arise.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A 1D NumPy array of shape (n,) containing the Euclidean distances between corresponding points in <cite>x</cite> and <cite>y</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
<dt class="field-even">Example<span class="colon">:</span></dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span> <span class="p">[</span><span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span> <span class="p">[</span><span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">distances</span> <span class="o">=</span> <span class="n">get_euclidean_distance_cupy</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="simba.data_processors.cuda.statistics.sliding_mean">
<span class="sig-prename descclassname"><span class="pre">simba.data_processors.cuda.statistics.</span></span><span class="sig-name descname"><span class="pre">sliding_mean</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_window</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_rate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/simba/data_processors/cuda/statistics.html#sliding_mean"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#simba.data_processors.cuda.statistics.sliding_mean" title="Permalink to this definition"></a></dt>
<dd><p>Computes the mean of values within a sliding window over a 1D numpy array <cite>x</cite> using CUDA for acceleration.</p>
<a class="reference internal image-reference" href="_images/sliding_mean_cuda.png"><img alt="_images/sliding_mean_cuda.png" class="align-center" src="_images/sliding_mean_cuda.png" style="width: 500px;" /></a>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<em>np.ndarray</em>) – The input 1D numpy array of floats. The array over which the sliding window sum is computed.</p>
</dd>
</dl>
<p>:param float time_window:The size of the sliding window in seconds. This window slides over the array <cite>x</cite> to compute the sum.
:param int sample_rate: The number of samples per second in the array <cite>x</cite>. This is used to convert the time-based window size into the number of samples.
:return np.ndarray: A numpy array containing the sum of values within each position of the sliding window.</p>
<dl class="field-list simple">
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="p">))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">time_window</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sample_rate</span> <span class="o">=</span> <span class="mi">10</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r_x</span> <span class="o">=</span> <span class="n">sliding_mean</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">time_window</span><span class="o">=</span><span class="n">time_window</span><span class="p">,</span> <span class="n">sample_rate</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="simba.data_processors.cuda.statistics.sliding_min">
<span class="sig-prename descclassname"><span class="pre">simba.data_processors.cuda.statistics.</span></span><span class="sig-name descname"><span class="pre">sliding_min</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_window</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_rate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/simba/data_processors/cuda/statistics.html#sliding_min"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#simba.data_processors.cuda.statistics.sliding_min" title="Permalink to this definition"></a></dt>
<dd><p>Computes the minimum value within a sliding window over a 1D numpy array <cite>x</cite> using CUDA for acceleration.</p>
<a class="reference internal image-reference" href="_images/sliding_min_cuda.png"><img alt="_images/sliding_min_cuda.png" class="align-center" src="_images/sliding_min_cuda.png" style="width: 500px;" /></a>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>np.ndarray</em>) – Input 1D numpy array of floats. The array over which the sliding window minimum is computed.</p></li>
<li><p><strong>time_window</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a>) – The size of the sliding window in seconds.</p></li>
<li><p><strong>intsample_rate</strong> – The sampling rate of the data, which determines the number of samples per second.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A numpy array containing the minimum value for each position of the sliding window.</p>
</dd>
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10000000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">time_window</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sample_rate</span> <span class="o">=</span> <span class="mi">10</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sliding_min</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">time_window</span><span class="o">=</span><span class="n">time_window</span><span class="p">,</span> <span class="n">sample_rate</span><span class="o">=</span><span class="n">sample_rate</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="simba.data_processors.cuda.statistics.sliding_spearmans_rank">
<span class="sig-prename descclassname"><span class="pre">simba.data_processors.cuda.statistics.</span></span><span class="sig-name descname"><span class="pre">sliding_spearmans_rank</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_window</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_rate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.12)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">16000000</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/simba/data_processors/cuda/statistics.html#sliding_spearmans_rank"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#simba.data_processors.cuda.statistics.sliding_spearmans_rank" title="Permalink to this definition"></a></dt>
<dd><blockquote>
<div><p>Computes the Spearman’s rank correlation coefficient between two 1D arrays <cite>x</cite> and <cite>y</cite>
over sliding windows of size <cite>time_window * sample_rate</cite>. The computation is performed
in batches to optimize memory usage, leveraging GPU acceleration with CuPy.</p>
<div class="math">
<p><span class="math"></span></p>
</div></div></blockquote>
<p>ho = 1 -
rac{6 sum d_i^2}{n_w(n_w^2 - 1)}</p>
<blockquote>
<div><div class="math">
<p><span class="math">The function uses CuPy to perform GPU-accelerated calculations. Ensure that your environment
supports GPU computation with CuPy installed.</span></p>
</div><p>Where:
- (</p>
</div></blockquote>
<dl>
<dt>ho ) is the Spearman’s rank correlation coefficient.</dt><dd><ul class="simple">
<li><p>( d_i ) is the difference between the ranks of corresponding elements in the sliding window.</p></li>
<li><p>( n_w ) is the size of the sliding window.</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">param np.ndarray x<span class="colon">:</span></dt>
<dd class="field-odd"><p>The first 1D array containing the values for Feature 1.</p>
</dd>
<dt class="field-even">param np.ndarray y<span class="colon">:</span></dt>
<dd class="field-even"><p>The second 1D array containing the values for Feature 2.</p>
</dd>
<dt class="field-odd">param float time_window<span class="colon">:</span></dt>
<dd class="field-odd"><p>The size of the sliding window in seconds.</p>
</dd>
<dt class="field-even">param int sample_rate<span class="colon">:</span></dt>
<dd class="field-even"><p>The sampling rate (samples per second) of the data.</p>
</dd>
<dt class="field-odd">param Optional[int] batch_size<span class="colon">:</span></dt>
<dd class="field-odd"><p>The size of each batch to process at a time for memory efficiency. Defaults to 1.6e7.</p>
</dd>
<dt class="field-even">return<span class="colon">:</span></dt>
<dd class="field-even"><p>A 1D numpy array containing the Spearman’s rank correlation coefficient for each sliding window.</p>
</dd>
<dt class="field-odd">rtype<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
<dt class="field-even">example<span class="colon">:</span></dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">11</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">26</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">19</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sliding_spearmans_rank</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">time_window</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">sample_rate</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="simba.data_processors.cuda.statistics.sliding_std">
<span class="sig-prename descclassname"><span class="pre">simba.data_processors.cuda.statistics.</span></span><span class="sig-name descname"><span class="pre">sliding_std</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_window</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_rate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/simba/data_processors/cuda/statistics.html#sliding_std"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#simba.data_processors.cuda.statistics.sliding_std" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<em>np.ndarray</em>) – The input 1D numpy array of floats. The array over which the sliding window sum is computed.</p>
</dd>
</dl>
<p>:param float time_window:The size of the sliding window in seconds. This window slides over the array <cite>x</cite> to compute the sum.
:param int sample_rate: The number of samples per second in the array <cite>x</cite>. This is used to convert the time-based window size into the number of samples.
:return np.ndarray: A numpy array containing the sum of values within each position of the sliding window.</p>
<dl class="field-list simple">
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="p">))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">time_window</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sample_rate</span> <span class="o">=</span> <span class="mi">10</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r_x</span> <span class="o">=</span> <span class="n">sliding_sum</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">time_window</span><span class="o">=</span><span class="n">time_window</span><span class="p">,</span> <span class="n">sample_rate</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="simba.data_processors.cuda.statistics.sliding_sum">
<span class="sig-prename descclassname"><span class="pre">simba.data_processors.cuda.statistics.</span></span><span class="sig-name descname"><span class="pre">sliding_sum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_window</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_rate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/simba/data_processors/cuda/statistics.html#sliding_sum"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#simba.data_processors.cuda.statistics.sliding_sum" title="Permalink to this definition"></a></dt>
<dd><p>Computes the sum of values within a sliding window over a 1D numpy array <cite>x</cite> using CUDA for acceleration.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<em>np.ndarray</em>) – The input 1D numpy array of floats. The array over which the sliding window sum is computed.</p>
</dd>
</dl>
<p>:param float time_window:The size of the sliding window in seconds. This window slides over the array <cite>x</cite> to compute the sum.
:param int sample_rate: The number of samples per second in the array <cite>x</cite>. This is used to convert the time-based window size into the number of samples.
:return np.ndarray: A numpy array containing the sum of values within each position of the sliding window.</p>
<dl class="field-list simple">
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="p">))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">time_window</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sample_rate</span> <span class="o">=</span> <span class="mi">10</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r_x</span> <span class="o">=</span> <span class="n">sliding_sum</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">time_window</span><span class="o">=</span><span class="n">time_window</span><span class="p">,</span> <span class="n">sample_rate</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-simba.data_processors.cuda.circular_statistics">
<span id="circular-statistics"></span><h2>Circular statistics<a class="headerlink" href="#module-simba.data_processors.cuda.circular_statistics" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="simba.data_processors.cuda.circular_statistics.direction_from_two_bps">
<span class="sig-prename descclassname"><span class="pre">simba.data_processors.cuda.circular_statistics.</span></span><span class="sig-name descname"><span class="pre">direction_from_two_bps</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/simba/data_processors/cuda/circular_statistics.html#direction_from_two_bps"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#simba.data_processors.cuda.circular_statistics.direction_from_two_bps" title="Permalink to this definition"></a></dt>
<dd><p>Compute the directionality in degrees from two body-parts. E.g., <code class="docutils literal notranslate"><span class="pre">nape</span></code> and <code class="docutils literal notranslate"><span class="pre">nose</span></code>,
or <code class="docutils literal notranslate"><span class="pre">swim_bladder</span></code> and <code class="docutils literal notranslate"><span class="pre">tail</span></code> with GPU acceleration.</p>
<a class="reference internal image-reference" href="_static/img/direction_from_two_bps_cuda.png"><img alt="_static/img/direction_from_two_bps_cuda.png" class="align-center" src="_static/img/direction_from_two_bps_cuda.png" style="width: 1200px;" /></a>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>np.ndarray</em>) – Size len(frames) x 2 representing x and y coordinates for first body-part.</p></li>
<li><p><strong>y</strong> (<em>np.ndarray</em>) – Size len(frames) x 2 representing x and y coordinates for second body-part.</p></li>
</ul>
</dd>
<dt class="field-even">Return np.ndarray<span class="colon">:</span></dt>
<dd class="field-even"><p>Frame-wise directionality in degrees.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="simba.data_processors.cuda.circular_statistics.sliding_circular_hotspots">
<span class="sig-prename descclassname"><span class="pre">simba.data_processors.cuda.circular_statistics.</span></span><span class="sig-name descname"><span class="pre">sliding_circular_hotspots</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_window</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_rate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">bins</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.12)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">35000000</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/simba/data_processors/cuda/circular_statistics.html#sliding_circular_hotspots"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#simba.data_processors.cuda.circular_statistics.sliding_circular_hotspots" title="Permalink to this definition"></a></dt>
<dd><p>Calculate the proportion of data points falling within specified circular bins over a sliding time window using GPU</p>
<p>This function processes time series data representing angles (in degrees) and calculates the proportion of data
points within specified angular bins over a sliding window. The calculations are performed in batches to
accommodate large datasets efficiently.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>np.ndarray</em>) – The input time series data in degrees. Should be a 1D numpy array.</p></li>
<li><p><strong>time_window</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a>) – The size of the sliding window in seconds.</p></li>
<li><p><strong>sample_rate</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a>) – The sample rate of the time series data (i.e., hz, fps).</p></li>
<li><p><strong>bins</strong> (<em>ndarray</em>) – 2D array of shape representing circular bins defining [start_degree, end_degree] inclusive.</p></li>
<li><p><strong>batch_size</strong> (<em>Optional</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a><em>]</em>) – The size of each batch for processing the data. Default is 5e+7 (50m).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A 2D numpy array where each row corresponds to a time point in <cite>data</cite>, and each column represents a circular bin. The values in the array represent the proportion of data points within each bin at each time point. The first column represents the first bin.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="simba.data_processors.cuda.circular_statistics.sliding_circular_mean">
<span class="sig-prename descclassname"><span class="pre">simba.data_processors.cuda.circular_statistics.</span></span><span class="sig-name descname"><span class="pre">sliding_circular_mean</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_window</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_rate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.12)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">30000000.0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/simba/data_processors/cuda/circular_statistics.html#sliding_circular_mean"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#simba.data_processors.cuda.circular_statistics.sliding_circular_mean" title="Permalink to this definition"></a></dt>
<dd><p>Calculate the sliding circular mean over a time window for a series of angles.</p>
<p>This function computes the circular mean of angles in the input array <cite>x</cite> over a specified sliding window.
The circular mean is a measure of the average direction for angles, which is especially useful for angular data
where traditional averaging would not be meaningful due to the circular nature of angles (e.g., 359° and 1° should average to 0°).</p>
<p>The calculation is performed using a sliding window approach, where the circular mean is computed for each window
of angles. The function leverages GPU acceleration via CuPy for efficiency when processing large datasets.</p>
<p>The circular mean <span class="math">\mu</span> for a set of angles is calculated using the following formula:</p>
<div class="math">
<p><span class="math">\mu = \text{atan2}\left(\frac{1}{N} \sum_{i=1}^{N} \sin(\theta_i), \frac{1}{N} \sum_{i=1}^{N} \cos(\theta_i)\right)</span></p>
</div><ul class="simple">
<li><p><span class="math">\theta_i</span> are the angles in radians within the sliding window</p></li>
<li><p><span class="math">N</span> is the number of samples in the window</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>np.ndarray</em>) – Input array containing angle values in degrees. The array should be 1-dimensional.</p></li>
<li><p><strong>time_window</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a>) – Time duration for the sliding window, in seconds. This determines the number of samples in each window  based on the <cite>sample_rate</cite>.</p></li>
<li><p><strong>sample_rate</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – The number of samples per second (i.e., FPS). This is used to calculate the window size in terms of array indices.</p></li>
<li><p><strong>batch_size</strong> (<em>Optional</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a><em>]</em>) – The maximum number of elements to process in each batch. This is used to handle large arrays by processing them in chunks to avoid memory overflow. Defaults to 3e+7 (30 million elements).</p></li>
</ul>
</dd>
<dt class="field-even">Return np.ndarray<span class="colon">:</span></dt>
<dd class="field-even"><p>A 1D numpy array of the same length as <cite>x</cite>, containing the circular mean for each sliding window.  Values before the window is fully populated will be set to -1.</p>
</dd>
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">361</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="p">))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">results</span> <span class="o">=</span> <span class="n">sliding_circular_mean</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="simba.data_processors.cuda.circular_statistics.sliding_circular_range">
<span class="sig-prename descclassname"><span class="pre">simba.data_processors.cuda.circular_statistics.</span></span><span class="sig-name descname"><span class="pre">sliding_circular_range</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_window</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_rate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.12)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">50000000</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/simba/data_processors/cuda/circular_statistics.html#sliding_circular_range"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#simba.data_processors.cuda.circular_statistics.sliding_circular_range" title="Permalink to this definition"></a></dt>
<dd><p>Computes the sliding circular range of a time series data array using GPU.</p>
<p>This function calculates the circular range of a time series data array using a sliding window approach.
The input data is assumed to be in degrees, and the function handles the circular nature of the data
by considering the circular distance between angles.</p>
<div class="math">
<p><span class="math">R = \min \left( \text{max}(\Delta \theta) - \text{min}(\Delta \theta), \, 360 - \text{max}(\Delta \theta) + \text{min}(\Delta \theta) \right)</span></p>
</div><p>where:</p>
<ul class="simple">
<li><p><span class="math">\Delta \theta</span> is the difference between angles within the window,</p></li>
<li><p><span class="math">360</span> accounts for the circular nature of the data (i.e., wrap-around at 360 degrees).</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>np.ndarray</em>) – The input time series data in degrees. Should be a 1D numpy array.</p></li>
<li><p><strong>time_window</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a>) – The size of the sliding window in seconds.</p></li>
<li><p><strong>sample_rate</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a>) – The sample rate of the time series data (i.e., hz, fps).</p></li>
<li><p><strong>batch_size</strong> (<em>Optional</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a><em>]</em>) – The size of each batch for processing the data. Default is 5e+7 (50m).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A numpy array containing the sliding circular range values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
<dt class="field-even">Example<span class="colon">:</span></dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">361</span><span class="p">,</span> <span class="p">(</span><span class="mi">19</span><span class="p">,</span> <span class="p">))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="n">sliding_circular_range</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="simba.data_processors.cuda.circular_statistics.sliding_circular_std">
<span class="sig-prename descclassname"><span class="pre">simba.data_processors.cuda.circular_statistics.</span></span><span class="sig-name descname"><span class="pre">sliding_circular_std</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_window</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_rate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.12)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">50000000</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/simba/data_processors/cuda/circular_statistics.html#sliding_circular_std"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#simba.data_processors.cuda.circular_statistics.sliding_circular_std" title="Permalink to this definition"></a></dt>
<dd><blockquote>
<div><p>Calculate the sliding circular standard deviation of a time series data on GPU.</p>
<p>This function computes the circular standard deviation over a sliding window for a given time series array.
The time series data is assumed to be in degrees, and the function converts it to radians for computation.
The sliding window approach is used to handle large datasets efficiently, processing the data in batches.</p>
<p>The circular standard deviation (σ) is computed using the formula:</p>
<div class="math">
<p><span class="math">\sigma = \sqrt{-2 \cdot \log \left|      ext{mean}\left(\exp(i \cdot x_{ ext{batch}})</span></p>
</div></div></blockquote>
<p>ight)
ight|}</p>
<blockquote>
<div><p>where <span class="math">x_{    ext{batch}}</span> is the data within the current sliding window, and :math:` ext{mean}` and
<span class="math">\log</span> are computed in the circular (complex plane) domain.</p>
<dl class="field-list simple">
<dt class="field-odd">param np.ndarray x<span class="colon">:</span></dt>
<dd class="field-odd"><p>The input time series data in degrees. Should be a 1D numpy array.</p>
</dd>
<dt class="field-even">param float time_window<span class="colon">:</span></dt>
<dd class="field-even"><p>The size of the sliding window in seconds.</p>
</dd>
<dt class="field-odd">param float sample_rate<span class="colon">:</span></dt>
<dd class="field-odd"><p>The sample rate of the time series data (i.e., hz, fps).</p>
</dd>
<dt class="field-even">param Optional[int] batch_size<span class="colon">:</span></dt>
<dd class="field-even"><p>The size of each batch for processing the data. Default is 5e+7 (50m).</p>
</dd>
<dt class="field-odd">return<span class="colon">:</span></dt>
<dd class="field-odd"><p>A numpy array containing the sliding circular standard deviation values.</p>
</dd>
<dt class="field-even">rtype<span class="colon">:</span></dt>
<dd class="field-even"><p>np.ndarray</p>
</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="simba.data_processors.cuda.circular_statistics.sliding_rayleigh_z">
<span class="sig-prename descclassname"><span class="pre">simba.data_processors.cuda.circular_statistics.</span></span><span class="sig-name descname"><span class="pre">sliding_rayleigh_z</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_window</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_rate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.12)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">50000000</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.12)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/simba/data_processors/cuda/circular_statistics.html#sliding_rayleigh_z"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#simba.data_processors.cuda.circular_statistics.sliding_rayleigh_z" title="Permalink to this definition"></a></dt>
<dd><blockquote>
<div><p>Computes the Rayleigh Z-statistic over a sliding window for a given time series of angles</p>
<p>This function calculates the Rayleigh Z-statistic, which tests the null hypothesis that the population of angles
is uniformly distributed around the circle. The calculation is performed over a sliding window across the input
time series, and results are computed in batches for memory efficiency.</p>
<p>Data is processed using GPU acceleration via CuPy, which allows for faster computation compared to a CPU-based approach.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Adapted from <code class="docutils literal notranslate"><span class="pre">pingouin.circular.circ_rayleigh</span></code> and <code class="docutils literal notranslate"><span class="pre">pycircstat.tests.rayleigh</span></code>.</p>
</div>
<p><strong>Rayleigh Z-statistic:</strong></p>
<p>The Rayleigh Z-statistic is given by:</p>
<div class="math">
<p><span class="math">R =</span></p>
</div></div></blockquote>
<p>rac{1}{n} sqrt{left(sum_{i=1}^{n} cos(  heta_i)
ight)^2 + left(sum_{i=1}^{n} sin(    heta_i)
ight)^2}</p>
<blockquote>
<div><p>where:
- :math:`   heta_i` are the angles in the window.
- <span class="math">n</span> is the number of angles in the window.</p>
<dl class="field-list simple">
<dt class="field-odd">param np.ndarray x<span class="colon">:</span></dt>
<dd class="field-odd"><p>Input array of angles in degrees. Should be a 1D numpy array.</p>
</dd>
<dt class="field-even">param float time_window<span class="colon">:</span></dt>
<dd class="field-even"><p>The size of the sliding window in time units (e.g., seconds).</p>
</dd>
<dt class="field-odd">param float sample_rate<span class="colon">:</span></dt>
<dd class="field-odd"><p>The sampling rate of the input time series in samples per time unit (e.g., Hz, fps).</p>
</dd>
<dt class="field-even">param Optional[int] batch_size<span class="colon">:</span></dt>
<dd class="field-even"><p>The number of samples to process in each batch. Default is 5e7 (50m). Reducing this value may save memory at the cost of longer computation time.</p>
</dd>
<dt class="field-odd">return<span class="colon">:</span></dt>
<dd class="field-odd"><p>A tuple containing two numpy arrays:
- <strong>z_results</strong>: Rayleigh Z-statistics for each position in the input array where the window was fully applied.
- <strong>p_results</strong>: Corresponding p-values for the Rayleigh Z-statistics.</p>
</dd>
<dt class="field-even">rtype<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple[np.ndarray, np.ndarray]</p>
</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="simba.data_processors.cuda.circular_statistics.sliding_resultant_vector_length">
<span class="sig-prename descclassname"><span class="pre">simba.data_processors.cuda.circular_statistics.</span></span><span class="sig-name descname"><span class="pre">sliding_resultant_vector_length</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_window</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_rate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.12)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">30000000.0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/simba/data_processors/cuda/circular_statistics.html#sliding_resultant_vector_length"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#simba.data_processors.cuda.circular_statistics.sliding_resultant_vector_length" title="Permalink to this definition"></a></dt>
<dd><p>Calculate the sliding resultant vector length over a time window for a series of angles.</p>
<p>This function computes the resultant vector length (R) for each window of angles in the input array <cite>x</cite>.
The resultant vector length is a measure of the concentration of angles, and it ranges from 0 to 1, where 1
indicates all angles point in the same direction, and 0 indicates uniform distribution of angles.</p>
<p>For a given sliding window of angles, the resultant vector length <span class="math">R</span> is calculated using the following formula:</p>
<div class="math">
<p><span class="math">R = \frac{1}{N} \sqrt{\left(\sum_{i=1}^{N} \cos(\theta_i)\right)^2 + \left(\sum_{i=1}^{N} \sin(\theta_i)\right)^2}</span></p>
</div><p>where:</p>
<ul class="simple">
<li><p><span class="math">\theta_i</span> are the angles in radians within the sliding window</p></li>
<li><p><span class="math">N</span> is the number of samples in the window</p></li>
</ul>
<p>The computation is performed in a sliding window manner over the entire array, utilizing GPU acceleration
with CuPy for efficiency, especially on large datasets.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>np.ndarray</em>) – Input array containing angle values in degrees. The array should be 1-dimensional.</p></li>
<li><p><strong>time_window</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a>) – Time duration for the sliding window, in seconds. This determines the number of samples in each window  based on the <cite>sample_rate</cite>.</p></li>
<li><p><strong>sample_rate</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – The number of samples per second (i.e., FPS). This is used to calculate the window size in terms of array indices.</p></li>
<li><p><strong>batch_size</strong> (<em>Optional</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a><em>]</em>) – The maximum number of elements to process in each batch. This is used to handle large arrays by processing them in chunks to avoid memory overflow. Defaults to 3e+7 (30 million elements).</p></li>
</ul>
</dd>
<dt class="field-even">Return np.ndarray<span class="colon">:</span></dt>
<dd class="field-even"><p>A 1D numpy array of the same length as <cite>x</cite>, containing the resultant vector length for each sliding window. Values before the window is fully populated will be set to -1.</p>
</dd>
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">361</span><span class="p">,</span> <span class="p">(</span><span class="mi">5000</span><span class="p">,</span> <span class="p">))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">results</span> <span class="o">=</span> <span class="n">sliding_resultant_vector_length</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-simba.data_processors.cuda.image">
<span id="image"></span><h2>Image<a class="headerlink" href="#module-simba.data_processors.cuda.image" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="simba.data_processors.cuda.image.create_average_frm_cuda">
<span class="sig-prename descclassname"><span class="pre">simba.data_processors.cuda.image.</span></span><span class="sig-name descname"><span class="pre">create_average_frm_cuda</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">video_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.12)"><span class="pre">Union</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/os.html#os.PathLike" title="(in Python v3.12)"><span class="pre">PathLike</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_frm</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.12)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end_frm</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.12)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_time</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.12)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end_time</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.12)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.12)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.12)"><span class="pre">Union</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/os.html#os.PathLike" title="(in Python v3.12)"><span class="pre">PathLike</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.12)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">6000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.12)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.12)"><span class="pre">Union</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/simba/data_processors/cuda/image.html#create_average_frm_cuda"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#simba.data_processors.cuda.image.create_average_frm_cuda" title="Permalink to this definition"></a></dt>
<dd><blockquote>
<div><p>Computes the average frame using GPU acceleration from a specified range of frames or time interval in a video file.
This average frame typically used for background substraction.</p>
<p>The function reads frames from the video, calculates their average, and optionally saves the result
to a specified file. If <cite>save_path</cite> is provided, the average frame is saved as an image file;
otherwise, the average frame is returned as a NumPy array.</p>
<dl class="field-list simple">
<dt class="field-odd">param Union[str, os.PathLike] video_path<span class="colon">:</span></dt>
<dd class="field-odd"><p>The path to the video file from which to extract frames.</p>
</dd>
<dt class="field-even">param Optional[int] start_frm<span class="colon">:</span></dt>
<dd class="field-even"><p>The starting frame number (inclusive). Either <cite>start_frm</cite>/<cite>end_frm</cite> or <cite>start_time</cite>/<cite>end_time</cite> must be provided, but not both.</p>
</dd>
<dt class="field-odd">param Optional[int] end_frm<span class="colon">:</span></dt>
<dd class="field-odd"><p>The ending frame number (exclusive).</p>
</dd>
<dt class="field-even">param Optional[str] start_time<span class="colon">:</span></dt>
<dd class="field-even"><p>The start time in the format ‘HH:MM:SS’ from which to begin extracting frames.</p>
</dd>
<dt class="field-odd">param Optional[str] end_time<span class="colon">:</span></dt>
<dd class="field-odd"><p>The end time in the format ‘HH:MM:SS’ up to which frames should be extracted.</p>
</dd>
<dt class="field-even">param Optional[Union[str, os.PathLike]] save_path<span class="colon">:</span></dt>
<dd class="field-even"><p>The path where the average frame image will be saved. If <cite>None</cite>, the average frame is returned as a NumPy array.</p>
</dd>
<dt class="field-odd">param Optional[int] batch_size<span class="colon">:</span></dt>
<dd class="field-odd"><p>The number of frames to process in each batch. Default is 3000. Increase if your RAM allows it.</p>
</dd>
<dt class="field-even">param Optional[bool] verbose<span class="colon">:</span></dt>
<dd class="field-even"><p>If <cite>True</cite>, prints progress and informational messages during execution.</p>
</dd>
<dt class="field-odd">return<span class="colon">:</span></dt>
<dd class="field-odd"><p>Returns <cite>None</cite> if the result is saved to <cite>save_path</cite>. Otherwise, returns the average frame as a NumPy array.</p>
</dd>
<dt class="field-even">example<span class="colon">:</span></dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">create_average_frm</span><span class="p">(</span><span class="n">video_path</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;C:      roubleshooting\RAT_NOR\project_folder</span>
</pre></div>
</div>
</div></blockquote>
<p>ideos2-06-20_NOB_DOT_4_downsampled.mp4”, verbose=True, start_frm=0, end_frm=9000)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="simba.data_processors.cuda.image.create_average_frm_cupy">
<span class="sig-prename descclassname"><span class="pre">simba.data_processors.cuda.image.</span></span><span class="sig-name descname"><span class="pre">create_average_frm_cupy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">video_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.12)"><span class="pre">Union</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/os.html#os.PathLike" title="(in Python v3.12)"><span class="pre">PathLike</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_frm</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.12)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end_frm</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.12)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_time</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.12)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end_time</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.12)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.12)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.12)"><span class="pre">Union</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/os.html#os.PathLike" title="(in Python v3.12)"><span class="pre">PathLike</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.12)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">3000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.12)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.12)"><span class="pre">Union</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/simba/data_processors/cuda/image.html#create_average_frm_cupy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#simba.data_processors.cuda.image.create_average_frm_cupy" title="Permalink to this definition"></a></dt>
<dd><blockquote>
<div><p>Computes the average frame using GPU acceleration from a specified range of frames or time interval in a video file.
This average frame typically used for background substraction.</p>
<p>The function reads frames from the video, calculates their average, and optionally saves the result
to a specified file. If <cite>save_path</cite> is provided, the average frame is saved as an image file;
otherwise, the average frame is returned as a NumPy array.</p>
<dl class="field-list simple">
<dt class="field-odd">param Union[str, os.PathLike] video_path<span class="colon">:</span></dt>
<dd class="field-odd"><p>The path to the video file from which to extract frames.</p>
</dd>
<dt class="field-even">param Optional[int] start_frm<span class="colon">:</span></dt>
<dd class="field-even"><p>The starting frame number (inclusive). Either <cite>start_frm</cite>/<cite>end_frm</cite> or <cite>start_time</cite>/<cite>end_time</cite> must be provided, but not both.</p>
</dd>
<dt class="field-odd">param Optional[int] end_frm<span class="colon">:</span></dt>
<dd class="field-odd"><p>The ending frame number (exclusive).</p>
</dd>
<dt class="field-even">param Optional[str] start_time<span class="colon">:</span></dt>
<dd class="field-even"><p>The start time in the format ‘HH:MM:SS’ from which to begin extracting frames.</p>
</dd>
<dt class="field-odd">param Optional[str] end_time<span class="colon">:</span></dt>
<dd class="field-odd"><p>The end time in the format ‘HH:MM:SS’ up to which frames should be extracted.</p>
</dd>
<dt class="field-even">param Optional[Union[str, os.PathLike]] save_path<span class="colon">:</span></dt>
<dd class="field-even"><p>The path where the average frame image will be saved. If <cite>None</cite>, the average frame is returned as a NumPy array.</p>
</dd>
<dt class="field-odd">param Optional[int] batch_size<span class="colon">:</span></dt>
<dd class="field-odd"><p>The number of frames to process in each batch. Default is 3000. Increase if your RAM allows it.</p>
</dd>
<dt class="field-even">param Optional[bool] verbose<span class="colon">:</span></dt>
<dd class="field-even"><p>If <cite>True</cite>, prints progress and informational messages during execution.</p>
</dd>
<dt class="field-odd">return<span class="colon">:</span></dt>
<dd class="field-odd"><p>Returns <cite>None</cite> if the result is saved to <cite>save_path</cite>. Otherwise, returns the average frame as a NumPy array.</p>
</dd>
<dt class="field-even">example<span class="colon">:</span></dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">create_average_frm_cupy</span><span class="p">(</span><span class="n">video_path</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;C: roubleshooting\RAT_NOR\project_folder</span>
</pre></div>
</div>
</div></blockquote>
<p>ideos2-06-20_NOB_DOT_4_downsampled.mp4”, verbose=True, start_frm=0, end_frm=9000)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="simba.data_processors.cuda.image.img_stack_brightness">
<span class="sig-prename descclassname"><span class="pre">simba.data_processors.cuda.image.</span></span><span class="sig-name descname"><span class="pre">img_stack_brightness</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.12)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><span class="pre">typing_extensions.Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'photometric'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'digital'</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'digital'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ignore_black</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.12)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/simba/data_processors/cuda/image.html#img_stack_brightness"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#simba.data_processors.cuda.image.img_stack_brightness" title="Permalink to this definition"></a></dt>
<dd><p>Calculate the average brightness of a stack of images using a specified method.</p>
<ul class="simple">
<li><p><strong>Photometric Method</strong>: The brightness is calculated using the formula:</p></li>
</ul>
<div class="math">
<p><span class="math">ext{brightness} = 0.2126 \cdot R + 0.7152 \cdot G + 0.0722 \cdot B</span></p>
</div><ul class="simple">
<li><p><strong>Digital Method</strong>: The brightness is calculated using the formula:</p></li>
</ul>
<div class="math">
<p><span class="math">ext{brightness} = 0.299 \cdot R + 0.587 \cdot G + 0.114 \cdot B</span></p>
</div><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>np.ndarray</em>) – A 4D array of images with dimensions (N, H, W, C), where N is the number of images, H and W are the height and width, and C is the number of channels (RGB).</p></li>
<li><p><strong>method</strong> (<em>Optional</em><em>[</em><em>Literal</em><em>[</em><em>'photometric'</em><em>, </em><em>'digital'</em><em>]</em><em>]</em>) – The method to use for calculating brightness. It can be ‘photometric’ for  the standard luminance calculation or ‘digital’ for an alternative set of coefficients. Default is ‘digital’.</p></li>
<li><p><strong>ignore_black</strong> (<em>Optional</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><em>bool</em></a><em>]</em>) – If True, black pixels (i.e., pixels with brightness value 0) will be ignored in the calculation of the average brightness. Default is True.</p></li>
</ul>
</dd>
<dt class="field-even">Return np.ndarray<span class="colon">:</span></dt>
<dd class="field-even"><p>A 1D array of average brightness values for each image in the stack. If <cite>ignore_black</cite> is True, black pixels are ignored in the averaging process.</p>
</dd>
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">imgs</span> <span class="o">=</span> <span class="n">read_img_batch_from_video_gpu</span><span class="p">(</span><span class="n">video_path</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;/mnt/c/troubleshooting/RAT_NOR/project_folder/videos/2022-06-20_NOB_DOT_4_downsampled.mp4&quot;</span><span class="p">,</span> <span class="n">start_frm</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">end_frm</span><span class="o">=</span><span class="mi">5000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">imgs</span><span class="o">.</span><span class="n">values</span><span class="p">()),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">img_stack_brightness</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">imgs</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="simba.data_processors.cuda.image.img_stack_to_grayscale_cuda">
<span class="sig-prename descclassname"><span class="pre">simba.data_processors.cuda.image.</span></span><span class="sig-name descname"><span class="pre">img_stack_to_grayscale_cuda</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/simba/data_processors/cuda/image.html#img_stack_to_grayscale_cuda"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#simba.data_processors.cuda.image.img_stack_to_grayscale_cuda" title="Permalink to this definition"></a></dt>
<dd><p>Convert image stack to grayscale using CUDA.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<em>np.ndarray</em>) – 4d array of color images in numpy format.</p>
</dd>
<dt class="field-even">Return np.ndarray<span class="colon">:</span></dt>
<dd class="field-even"><p>3D array of greyscaled images.</p>
</dd>
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">imgs</span> <span class="o">=</span> <span class="n">read_img_batch_from_video_gpu</span><span class="p">(</span><span class="n">video_path</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;/mnt/c/troubleshooting/mitra/project_folder/videos/temp_2/592_MA147_Gq_Saline_0516_downsampled.mp4&quot;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">start_frm</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">end_frm</span><span class="o">=</span><span class="n">i</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">imgs</span><span class="o">.</span><span class="n">values</span><span class="p">()),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">grey_images</span> <span class="o">=</span> <span class="n">img_stack_to_grayscale_cuda</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">imgs</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="simba.data_processors.cuda.image.img_stack_to_grayscale_cupy">
<span class="sig-prename descclassname"><span class="pre">simba.data_processors.cuda.image.</span></span><span class="sig-name descname"><span class="pre">img_stack_to_grayscale_cupy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">imgs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.12)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">250</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/simba/data_processors/cuda/image.html#img_stack_to_grayscale_cupy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#simba.data_processors.cuda.image.img_stack_to_grayscale_cupy" title="Permalink to this definition"></a></dt>
<dd><p>Converts a stack of color images to grayscale using GPU acceleration with CuPy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>imgs</strong> (<em>np.ndarray</em>) – A 4D NumPy array representing a stack of images with shape (num_images, height, width, channels). The images are expected to have 3 channels (RGB).</p></li>
<li><p><strong>batch_size</strong> (<em>Optional</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a><em>]</em>) – The number of images to process in each batch. Defaults to 250. Adjust this parameter to fit your GPU’s memory capacity.</p></li>
</ul>
</dd>
<dt class="field-even">Return np.ndarray<span class="colon">:</span></dt>
<dd class="field-even"><p>m A 3D NumPy array of shape (num_images, height, width) containing the grayscale images. If the input array is not 4D, the function returns the input as is.</p>
</dd>
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">imgs</span> <span class="o">=</span> <span class="n">read_img_batch_from_video_gpu</span><span class="p">(</span><span class="n">video_path</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;/mnt/c/troubleshooting/RAT_NOR/project_folder/videos/2022-06-20_NOB_IOT_1_cropped.mp4&quot;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">start_frm</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">end_frm</span><span class="o">=</span><span class="n">i</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">imgs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">imgs</span><span class="o">.</span><span class="n">values</span><span class="p">()),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gray_imgs</span> <span class="o">=</span> <span class="n">img_stack_to_grayscale_cupy</span><span class="p">(</span><span class="n">imgs</span><span class="o">=</span><span class="n">imgs</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="simba.data_processors.cuda.image.stack_sliding_mse">
<span class="sig-prename descclassname"><span class="pre">simba.data_processors.cuda.image.</span></span><span class="sig-name descname"><span class="pre">stack_sliding_mse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.12)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.12)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1000</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/simba/data_processors/cuda/image.html#stack_sliding_mse"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#simba.data_processors.cuda.image.stack_sliding_mse" title="Permalink to this definition"></a></dt>
<dd><p>Computes the Mean Squared Error (MSE) between each image in a stack and a reference image,
where the reference image is determined by a sliding window approach with a specified stride.
The function is optimized for large image stacks by processing them in batches.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>np.ndarray</em>) – Input array of images, where the first dimension corresponds to the stack of images. The array should be either 3D (height, width, channels) or 4D (batch, height, width, channels).</p></li>
<li><p><strong>stride</strong> (<em>Optional</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a><em>]</em>) – The stride or step size for the sliding window that determines the reference image. Defaults to 1, meaning the previous image in the stack is used as the reference.</p></li>
<li><p><strong>batch_size</strong> (<em>Optional</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a><em>]</em>) – The number of images to process in a single batch. Larger batch sizes may improve performance but require more GPU memory.  Defaults to 1000.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A 1D NumPy array containing the MSE for each image in the stack compared to its corresponding reference image. The length of the array is equal to the number of images in the input stack.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="simba.video_processors.html" class="btn btn-neutral float-left" title="Video processors" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="notebooks.html" class="btn btn-neutral float-right" title="Notebooks" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, sronilsson.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>
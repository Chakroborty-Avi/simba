<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Batch Video Processing &mdash; SimBA 0.0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css" />
      <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
      <link rel="stylesheet" type="text/css" href="../_static/css/simba_theme.css" />
      <link rel="stylesheet" type="text/css" href="../_static/custom.css" />

  
    <link rel="shortcut icon" href="../_static/readthedocs_logo.png"/>
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
        <script>let toggleHintShow = 'Click to show';</script>
        <script>let toggleHintHide = 'Click to hide';</script>
        <script>let toggleOpenOnPrint = 'true';</script>
        <script src="../_static/togglebutton.js"></script>
        <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="SimBA Installation" href="installation.html" />
    <link rel="prev" title="Using multi-animal pose-estimation data in SimBA" href="multi_animal_pose.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            SimBA
              <img src="../_static/readthedocs_logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">API REFERENCE:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api.html">API Reference</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">NOTEBOOKS:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../notebooks.html">Notebooks</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">USER GUIDE / TUTORIALS:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../tutorials.html">Tutorials</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="roi.html">Regions of Interest (ROIs) in SimBA</a></li>
<li class="toctree-l2"><a class="reference internal" href="FSTTC.html">Calculating forward-spike time tiling coefficents in SimBA</a></li>
<li class="toctree-l2"><a class="reference internal" href="feature_subsets.html">Feature family sub-sets in SimBA</a></li>
<li class="toctree-l2"><a class="reference internal" href="user_defined_feature_class.html">User-defined ‘feature extraction’ scripts in SimBA</a></li>
<li class="toctree-l2"><a class="reference internal" href="kleinberg_filter.html">Kleinberg behavior classification smoothing in SimBA</a></li>
<li class="toctree-l2"><a class="reference internal" href="anchored_rois.html">Animal-anchored ROIs (bounding-boxes) in SimBA</a></li>
<li class="toctree-l2"><a class="reference internal" href="SHAP.html">Model explainability and calculating feature SHAP values in SimBA</a></li>
<li class="toctree-l2"><a class="reference internal" href="directionality_between_animals.html">Who is looking at who: calculate “directionality” between animals in SimBA</a></li>
<li class="toctree-l2"><a class="reference internal" href="classifier_validation.html">Post-classification Validation (detecting false-positives)</a></li>
<li class="toctree-l2"><a class="reference internal" href="cue_lights.html">Cue Light Analysis in SimBA</a></li>
<li class="toctree-l2"><a class="reference internal" href="multi_animal_pose.html">Using multi-animal pose-estimation data in SimBA</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Batch Video Processing</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#pipeline">Pipeline</a></li>
<li class="toctree-l3"><a class="reference internal" href="#step-1-folder-selection">Step 1: Folder Selection</a></li>
<li class="toctree-l3"><a class="reference internal" href="#step-2-the-batch-processing-interface">Step 2: The batch processing interface.</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#quick-settings">Quick settings</a></li>
<li class="toctree-l4"><a class="reference internal" href="#the-video-table">The video table</a></li>
<li class="toctree-l4"><a class="reference internal" href="#execute">Execute</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="installation.html">SimBA Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="create_user_defined_pose_config.html">User-defined pose-configurations in SimBA</a></li>
<li class="toctree-l2"><a class="reference internal" href="tools.html">Video processing tools in SimBA</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">WALKTHROUGHS:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../walkthroughs.html">Walkthroughs</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">LABELLING TUTORIALS:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../labelling.html">Labelling</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">FAQ:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="FAQ.html">Friendly Asked Questions (FAQ)</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">DOCS:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../docs/workflow.html">SimBA basic workflow</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">ABOUT:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../credits.html">Credits</a></li>
<li class="toctree-l1"><a class="reference internal" href="../credits.html#who-writes-this-stuff">Who writes this stuff??</a></li>
<li class="toctree-l1"><a class="reference internal" href="../links.html">Links</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">SimBA</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../tutorials.html">Tutorials</a></li>
      <li class="breadcrumb-item active">Batch Video Processing</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/tutorials_rst/process_videos.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<section id="batch-video-processing">
<h1>Batch Video Processing<a class="headerlink" href="#batch-video-processing" title="Permalink to this heading"></a></h1>
<p>It is often helpful, and sometimes necessary, to pre-process
experimental videos prior to analysis. This is generally accomplished
through the use of open-source approaches like <strong>FFmpeg</strong> or commercial
software, but can be a time consuming and cumbersome when applying to
numerous similar videos. To streamline this process, SimBA incorporates
<strong>FFmpeg</strong> into a a batch-process GUI.</p>
<p>This video pre-processing tool allows you to change multiple video
parameters (clip/trim/crop, etc.) for multiple videos in a batch-process
that is rapidly configured and then executed when ready. Once the
required parameters has been set for all the videos, the user press
<code class="docutils literal notranslate"><span class="pre">Execute</span></code> and the new videos will be generated according to the user
input. Videos are processed using <strong>FFmpeg</strong>. Click
<a class="reference external" href="https://m.wikihow.com/Install-FFmpeg-on-Windows">here</a> to learn how
to install FFmpeg on your computer.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Processing numerous high-resolution or long-duration videos
takes time. We strongly suggest that you not execute a batch until you
are ready to commit computational time to the process.**</p>
</div>
<p>We suggest pre-processing videos in the following scenarios:</p>
<ol class="arabic simple">
<li><p>Red-light: If you have recorded in red-light conditions, we suggest
converting to gray-scale and using CLAHE.</p></li>
<li><p>Reflections: If your recordings include reflections on the walls of
your testing apparatus, we suggest cropping to remove the
reflections.</p></li>
<li><p>Artifacts: If your recordings include frames where your hands (or
other unintended features) are included in the video, at either the
start or the end, we suggest trimming the videos to remove these
frames.</p></li>
<li><p>Resolution: If your recordings are significantly higher resolution
than needed, we suggest down-sampling to decrease processing time.</p></li>
</ol>
<section id="pipeline">
<h2>Pipeline<a class="headerlink" href="#pipeline" title="Permalink to this heading"></a></h2>
<p>The video parameters that you specify will be processed in the following
sequence. If the user leaves certain parameters unchanged, then they are
ignored in the pipeline.</p>
<a class="reference internal image-reference" href="../_images/flow_diagram.png"><img alt="../_images/flow_diagram.png" class="align-center" src="../_images/flow_diagram.png" style="width: 800px;" /></a>
</section>
<section id="step-1-folder-selection">
<h2>Step 1: Folder Selection<a class="headerlink" href="#step-1-folder-selection" title="Permalink to this heading"></a></h2>
<a class="reference internal image-reference" href="../_images/menu_18.png"><img alt="../_images/menu_18.png" class="align-center" src="../_images/menu_18.png" style="width: 1000px;" /></a>
<ol class="arabic simple">
<li><p>To begin batch pre-processing, in the main SimBA window click on
<code class="docutils literal notranslate"><span class="pre">Process</span> <span class="pre">Videos</span></code> –&gt; <code class="docutils literal notranslate"><span class="pre">Batch</span> <span class="pre">pre-process</span> <span class="pre">videos</span></code>. The window shown
below will display.</p></li>
</ol>
<a class="reference internal image-reference" href="../_images/menu_23.png"><img alt="../_images/menu_23.png" class="align-center" src="../_images/menu_23.png" style="width: 1000px;" /></a>
<ol class="arabic simple" start="2">
<li><p>Under <strong>Folder Selection</strong> heading and next to <code class="docutils literal notranslate"><span class="pre">Video</span> <span class="pre">directory</span></code>,
click on <code class="docutils literal notranslate"><span class="pre">Browse</span> <span class="pre">Folder</span></code> and navigate to a folder that contains the
videos that should be batch processed and click on ’Select Folder`.
All vidoes that you would like to process must be present in this
directory.</p></li>
</ol>
<a class="reference internal image-reference" href="../_images/menu_33.png"><img alt="../_images/menu_33.png" class="align-center" src="../_images/menu_33.png" style="width: 1000px;" /></a>
<ol class="arabic simple" start="3">
<li><p>Next to <code class="docutils literal notranslate"><span class="pre">Output</span> <span class="pre">Directory</span></code>, click on <code class="docutils literal notranslate"><span class="pre">Browse</span> <span class="pre">Folder</span></code> and navigate
to a folder <em>(usually a new, empty, folder)</em> that should store the
processed videos and click on ’Select Folder`.</p></li>
<li><p>Click to <code class="docutils literal notranslate"><span class="pre">Confirm</span></code> the two selected directories.</p></li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Please make sure there is no spaces in your folder names or
video names. Instead use underscores if needed.</p>
</div>
<a class="reference internal image-reference" href="../_images/menu_42.png"><img alt="../_images/menu_42.png" class="align-center" src="../_images/menu_42.png" style="width: 1000px;" /></a>
</section>
<section id="step-2-the-batch-processing-interface">
<h2>Step 2: The batch processing interface.<a class="headerlink" href="#step-2-the-batch-processing-interface" title="Permalink to this heading"></a></h2>
<ol class="arabic simple">
<li><p>Once you select <code class="docutils literal notranslate"><span class="pre">Confirm</span></code>, an interface will be displayed which
will allow us to manipulate the attributes of each video, or batch
change attributes of all videos in the directory. Below is a
screengrab of this interface, which I have labelled into three
different parts: <strong>(1) QUICK SETTINGS, (2) VIDEOS, and (3) EXECUTE</strong>.
We will go through the functions of each one in turn.</p></li>
</ol>
<a class="reference internal image-reference" href="../_images/menu_53.png"><img alt="../_images/menu_53.png" class="align-center" src="../_images/menu_53.png" style="width: 1000px;" /></a>
<section id="quick-settings">
<h3>Quick settings<a class="headerlink" href="#quick-settings" title="Permalink to this heading"></a></h3>
<p>The quick setting menu allows us to batch specify new resolutions, new
frames rates, or clipping times for all videos. In my toy example I have
10 videos, each which is 10s long (Note: you can see that they are 10s
long in the middle <strong>VIDEOS</strong> table, by looking in the <em>End Time</em>
column, shich SimBa has populated with the video meta-information data).</p>
<p>Let’s say I want to remove the first 5s from each of the videos, and to
do this I can use the <code class="docutils literal notranslate"><span class="pre">Clip</span> <span class="pre">Videos</span> <span class="pre">Settings</span></code> sub-menu in QUICK
SETTINGS. To do this, I set the <code class="docutils literal notranslate"><span class="pre">Start</span> <span class="pre">Time</span></code> to 00:00:05, and the
<code class="docutils literal notranslate"><span class="pre">End</span> <span class="pre">Time</span></code> to 00:00:10 and click <code class="docutils literal notranslate"><span class="pre">Apply</span></code>, as in the gif below. Note
that the <code class="docutils literal notranslate"><span class="pre">Start</span> <span class="pre">Time</span></code> of all videos listed in the VIDEOS table are
updated:</p>
<a class="reference internal image-reference" href="../_images/quick_clip.gif"><img alt="../_images/quick_clip.gif" class="align-center" src="../_images/quick_clip.gif" style="width: 1000px;" /></a>
<p>Similarly, let say I want to downsample all my videos to a 1200x800
resolution. I then update the <code class="docutils literal notranslate"><span class="pre">Width</span></code> and <code class="docutils literal notranslate"><span class="pre">Height</span></code> values in the
<code class="docutils literal notranslate"><span class="pre">Downsample</span> <span class="pre">Videos</span></code> sub-menu, and click <code class="docutils literal notranslate"><span class="pre">Apply</span></code>:</p>
<a class="reference internal image-reference" href="../_images/quick_downsample.gif"><img alt="../_images/quick_downsample.gif" class="align-center" src="../_images/quick_downsample.gif" style="width: 1000px;" /></a>
</section>
<section id="the-video-table">
<h3>The video table<a class="headerlink" href="#the-video-table" title="Permalink to this heading"></a></h3>
<p>The middle VIDEOS table list all the video files found inside your input
directory defined in Step 1, with one video per row. Each video has a
<code class="docutils literal notranslate"><span class="pre">Crop</span></code> button, and several entry boxes and radio buttons that allows
us to specify which pre-processing functions we should apply to each
video. In the header of the VIDEOS table, there are also radio buttons
that allows us to tick all of the videos in the table. For example, if I
want to apply the 00:00:05 to 00:00:10 clip trimming to all videos, I go
ahead and click the <code class="docutils literal notranslate"><span class="pre">Clip</span> <span class="pre">all</span> <span class="pre">videos</span></code> radio button. If I want
downsample all videos, I go ahead and click the
<code class="docutils literal notranslate"><span class="pre">Downsample</span> <span class="pre">All</span> <span class="pre">Videos</span></code> radiobutton. If I want to <code class="docutils literal notranslate"><span class="pre">Clip</span> <span class="pre">all</span> <span class="pre">videos</span></code>
<em>except</em> few videos. I go ahead and de-select the videos I want to omit
from downsampling. The same applies for the FPS, greyscale, CLAHE and
Frame count radio buttons:</p>
<a class="reference internal image-reference" href="../_images/header_radiobtn.gif"><img alt="../_images/header_radiobtn.gif" class="align-center" src="../_images/header_radiobtn.gif" style="width: 1000px;" /></a>
<p>Next, it might be that you want to crop some of the videos listes in the
VIDEOS table. To do this, click on the <code class="docutils literal notranslate"><span class="pre">Crop</span></code> button associated with
the video. In this scenario I want to crop Video 1, and click the
<code class="docutils literal notranslate"><span class="pre">Crop</span></code> button. Once clicked, the first frame of <code class="docutils literal notranslate"><span class="pre">Video</span> <span class="pre">1</span></code> pops open.
To draw the region of the video to keep, click and hold the left mouse
button at the top left corner of your rectangular region and drag the
mouse to the bottom right corner of the rectanglar region. If you’re
unhappy with your rectangle, start to draw the rectangle again by
holding the left mouse button at the top left corner of your, new,
revised, rectangle. The previous rectangle will be automatically
discarded. When you are happy with your region, press the keyboard SPACE
or ESC button to save your rectangle. Notice that the <code class="docutils literal notranslate"><span class="pre">Crop</span></code> button
associated with Video 1 turns red after I’ve defined the cropped region.</p>
<a class="reference internal image-reference" href="../_images/crop.gif"><img alt="../_images/crop.gif" class="align-center" src="../_images/crop.gif" style="width: 1000px;" /></a>
<p>Chose with types of manipulation you which to perform on each video.
Once done, head to the <strong>EXECUTE</strong> section. To learn more about each
individual manipulation, check out their descriptions in the <a class="reference external" href="https://github.com/sgoldenlab/simba/blob/master/docs/Tutorial_tools.md">SimBA
TOOLS
Guide</a>.</p>
</section>
<section id="execute">
<h3>Execute<a class="headerlink" href="#execute" title="Permalink to this heading"></a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">Execute</span></code> section contains three buttons: (i) RESET ALL, (ii) RESET
CROP, and (iii) EXECUTE.</p>
<p><strong>RESET ALL</strong>: The RESET ALL button puts all the choices back to how
they were when opening the batch processing interface:</p>
<a class="reference internal image-reference" href="../_images/reset.gif"><img alt="../_images/reset.gif" class="align-center" src="../_images/reset.gif" style="width: 1000px;" /></a>
<p><strong>RESET CROP</strong>: The RESET CROP button removes all crop settings only
(once clicking the <code class="docutils literal notranslate"><span class="pre">RESET</span> <span class="pre">CROP</span></code> button, you should see any red
<code class="docutils literal notranslate"><span class="pre">Crop</span></code> button associated the videos go bck to their original color).</p>
<p><strong>EXECUTE</strong>: The <code class="docutils literal notranslate"><span class="pre">EXECUTE</span></code> button initates your chosen manipulations
on each video according the settings in the VIDEO TABLE. The results are
stored in the <code class="docutils literal notranslate"><span class="pre">Output</span> <span class="pre">Directory</span></code> defined during Step 1 above. Together
with the output files, there is a <code class="docutils literal notranslate"><span class="pre">.json</span></code> file that is also saved in
the output directory. This <code class="docutils literal notranslate"><span class="pre">.json</span></code> file contains the information on
the manipulations performed on the videos in the VIDEO TABLE. For an
exampple of this .json file, click
<a class="reference external" href="https://github.com/sgoldenlab/simba/blob/master/misc/batch_process_log.json">HERE</a>.</p>
<blockquote>
<div><div class="admonition important">
<p class="admonition-title">Important</p>
<p>If you have a lot of videos (&gt;100s), and are performing a lot
of manipulations, then batch pre-processing videos may take some
time, and it might be best to make it an over-nighter.</p>
</div>
</div></blockquote>
<p>If you have any questions, bug reports or feature requests, please let
us know by opening a new github issue or contact us through gitter and,
we will fix it together!</p>
<p>Author <a class="reference external" href="https://github.com/sronilsson">Simon N</a></p>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="multi_animal_pose.html" class="btn btn-neutral float-left" title="Using multi-animal pose-estimation data in SimBA" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="installation.html" class="btn btn-neutral float-right" title="SimBA Installation" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, sronilsson.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>